
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body>



<link type="text/css" rel="stylesheet" href="./index_files/banner-styles.css">



<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="petri dish, agar, cell, cells, virus, bacteria, blob, game, games, web game, html5, fun, flash">
<meta name="robots" content="index, follow">
<meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>Играть в Чашку Петри | play Petri Dish</title>

<link rel="alternate" hreflang="fr" href="http://petridish.pw/fr/">
<link rel="alternate" hreflang="en" href="http://petridish.pw/en/">
<link rel="alternate" hreflang="ru" href="http://petridish.pw/ru/">
<link rel="alternate" href="http://petridish.pw/" hreflang="x-default"> 

<link href="./index_files/css.css" rel="stylesheet" type="text/css">
<link href="./index_files/bootstrap2.css" rel="stylesheet">
<link href="./index_files/css" rel="stylesheet" type="text/css">


<link href="./index_files/fonts" rel="stylesheet" type="text/css">


 	<link rel="shortcut icon" href="favicon.ico">
	<link rel="image_src" href="/index_files/img/petri.jpg">



	<meta property="og:url" content="http://petridish.pw">
        <meta property="og:image" content="http://petridish.pw/img/petri.jpg">
        <meta property="og:title" content="Petri Dish - not an agar. Better than agar.">
        <meta property="og:site_name" content="Petri Dish - join us. Just for 5 minuts.">
	<meta name="description" content="Petri Dish - not an agar. Better than agar.">
        <meta property="og:type" content="website">




<script src="./index_files/jquery.js"></script>
<script src="./index_files/quadtree3.js"></script>



<script src="./index_files/canvas.min.js"></script>






<script>


if (window.location.protocol != "http:")
    window.location.href = "http:" + window.location.href.substring(window.location.protocol.length);


var datefromserver = '2015-12-27';
var datefromserveryesterday = '2015-12-26';
var datefromserveryesterdaymore = '2015-12-25';

var loaddate = '';
var impr = readCookie("impr");
if (impr == null) {
	createCookie('impr',1,999);
}
if (impr != null) {
	impr++;
	createCookie('impr',impr,999);
}
//console.log(impr);



var settedlang = 'ru';
createCookie('lang','ru',999);

</script>

<script src="./index_files/stats19.js"></script>














<style>

.chatwelcome {background-color:red;color:white;font-weight:bold;padding:2px;border-radius:3px;}
.chatwelcome a {color:yellow;}

.verified {background-repeat:no-repeat;width:16px;height:16px;background-image: url(/index_files/img/verified1.png);background-position:1px 3px;display:block;float:left;}
body{padding:0;margin:0;overflow:hidden;}

#langs img {cursor:pointer;}



.btn-success:active,.btn-success:hover,.btn-success:focus {
    border-color: #4cae4c !important;
outline:0;
}

option {outline:0;}
option:hover {background-color:#5cb85c;color:white;}
option[selected]{background-color:#449d44;color:white;}

table.admtable, table.admtable td { border:1px solid gray;  }
table.admtable td { padding: 1px 3px;}
a.command {cursor:pointer;}
table.admtable tr:hover { background-color:orange; font-weight:bold; }

#chat_textbox {
    background: rgba(0, 0, 0, 0.2) none repeat scroll 0 0;
    border: 0 none;
    bottom: 50px;
    color: black;
    font-weight:bold;
    height: 30px;
    left: 10px;
    outline: medium none;
    position: absolute;
    text-indent: 12px;
    transition: all 0.5s ease-in-out 0s;
    width: 300px;
    z-index: 1;
    border-radius: 10px;
    padding-right:10px;
}

#statArea ul li h2 { margin-top:0px; }
#statArea ul li { float:left; text-align:center; margin-right:40px; }
#statArea ul {margin-top:20px;text-align: center;}
#statArea ul li:nth-child(3) {margin-right:0px;}
#statArea ul li:nth-child(1) {margin-left:-15px;}

#region option[mode="VIRUSWARSFFA"]:nth-child(9) {margin-top:10px; }
#region option[mode="VIRUSWARSFFA"]:nth-child(11) {margin-top:10px; }
#region option[mode="FFA"]:nth-child(6) {margin-top:10px; }
#region option[mode="FFA"]:nth-child(7) {margin-top:10px; }
#region option[mode="FFA"]:nth-child(27) {margin-top:10px; }
#region option[mode="FFA"]:nth-child(31) {margin-top:10px; }

option.Canada { 
    background: rgba(0, 0, 0, 0) url("/index_files/img/ca.png") no-repeat scroll 0 0;
    padding-left: 22px;
}

option.Canada:hover {background-color:#5cb85c;color:white;}

option.Asia { 
    background: rgba(0, 0, 0, 0) url("/index_files/img/singapore.png") no-repeat scroll 0 0;
    padding-left: 22px;
}

option.Asia:hover {background-color:#5cb85c;color:white;}


option.ASIA { 
    background: rgba(0, 0, 0, 0) url("/index_files/img/jp.png") no-repeat scroll 0 0;
    padding-left: 22px;
}

option.ASIA:hover {background-color:#5cb85c;color:white;}

option.USA { 
    background: rgba(0, 0, 0, 0) url("/index_files/img/usa.png") no-repeat scroll 0 0;
    padding-left: 22px;
}

option.USA:hover {background-color:#5cb85c;color:white;}

option.France { 
    background: rgba(0, 0, 0, 0) url("/index_files/img/fr1.png") no-repeat scroll 0 0;
    padding-left: 22px;
}
option.France:hover {background-color:#5cb85c;color:white;}


option.Russia { 
    background: rgba(0, 0, 0, 0) url("/index_files/img/ru1.png") no-repeat scroll 0 0;
    padding-left: 22px;
}
option.Russia:hover {background-color:#5cb85c;color:white;}


option.Ukraine { 
    background: rgba(0, 0, 0, 0) url("/index_files/img/ua.png") no-repeat scroll 0 0;
    padding-left: 22px;
}
option.Ukraine:hover {background-color:#5cb85c;color:white;}

option.Germany { 
    background: rgba(0, 0, 0, 0) url("/index_files/img/de1.png") no-repeat scroll 0 0;
    padding-left: 22px;
}
option.Germany:hover {background-color:#5cb85c;color:white;}


#region option[mode="HARDCORE"]:nth-child(31) {margin-top:10px; }

#region option[mode="FASTFOOD"]:nth-child(8) {margin-top:10px; }

#chatlog {
    position: absolute;
    width: 300px;
    bottom: 90px;
    left: 10px;
font-size:14px;
color:black;
max-height:400px;
overflow:hidden;
}

.whitechat {
 border-radius: 10px;
 background-color: rgb(247,247,247);
 opacity: 0.8;
 padding:10px;
}

.blackchat {
 border-radius: 10px;
 background-color: rgb(16,16,16);
 opacity: 0.8;
 padding:10px;
 color:white;
}


#canvas{margin-left:0;position:absolute;left:0;right:0;top:0;bottom:0;width:100%;height:100%;}

.checkbox label{margin-right:10px;}form{margin-bottom:0px;}

.btn-play,.btn-settings,.btn-spectate{display:block;height:35px;}

.btn-play{width:100%;margin-top: 15px;}

.btn-spectate{display:block;float:left;}

#hint a, #clanhint a {color:red; font-style:italic;  }

.btn-gamemode {padding:1px 3px; margin-bottom:0px; width:120px;margin-left:30px;}

#locationUnknown #region{margin-bottom:15px;}

#spectateBtn{width:150px;margin-top:15px;margin-left:60px;margin-bottom:10px;}

#helloDialog{z-index:5;-webkit-box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);-moz-box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);width:500px;background-color:#FFFFFF;margin:10px auto;border-radius:250px;padding:5px 15px 5px 15px;position:absolute;top:50%;left:50%;margin-right:-50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}



#settingsDialog{display:none;-webkit-box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);-moz-box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);width:300px;background-color:#FFFFFF;margin:10px auto;border-radius:50px;padding:5px 15px 5px 15px;position:absolute;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}

#descriptionDialog{-webkit-box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);
-moz-box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);
box-shadow: 0px 0px 30px -2px rgba(0,0,0,0.5);
width:310px;
background-color:#FFFFFF;margin:10px auto;
border-radius:50px;
position:absolute;
padding: 20px;
top:50%;
-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);
display:none;
line-height:18px;
}

h1 {font-size:18px;}
h2 {font-size:18px;}

#donatewindow{width:300px;background-color:white;margin:10px auto;border-radius:50px;padding:5px 15px 5px 15px;position:absolute;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}

#settingsDialog label {margin-bottom:0px;}

#kompas { z-index:1; bottom:5px; left: 38%; position: absolute; }
#kompas input {margin-left:3px;text-align:center;border:2px solid gray; border-radius:9px;font-size:20px;opacity:0.7;padding:0 5px;width:70px; }
#kompas span {font-size:20px;font-weight:bold;}

a:hover {text-decoration:none;}


#gainArea li, #lossArea li { list-style: none; }
#gainArea ol, #lossArea ol, #gainArea ul, #lossArea ul { margin-left:-26px; }

#serverstats table {width:100%;}
#serverstats h1, #sername {text-align:center;}
#sername {font-style:italic;}
#serverstats tr:hover {font-weight:bold;color:red;}
#serverstats tr td:nth-child(1) {width:50px;}
#serverstats tr td:nth-child(2) {width:200px;}
#serverstats tr td:nth-child(3) {width:60px;text-align:center;}

#serverstats tr {display:none;}
#serverstats tr.top {display:table-row;}
#serverstats h1 {clear:both;}
#showallpers, #showallclans {cursor: pointer; border-bottom: 1px dashed; display: inline-block; float: right; margin-right: 14px; color: green; font-weight: bold; font-size: smaller;margin-bottom: 10px;}

.interval {cursor: pointer; border-bottom: 1px dashed; display: inline-block; margin-right: 10px; color: green; margin-bottom: 10px;margin-top:10px;font-size:small;}
.interval.active {font-weight:bold;}


</style>





<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  min-width:800px !important;
}
</style>

<!-- END WAYBACK TOOLBAR INSERT -->






<div id="overlays" style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; background: rgba(0, 0, 0, 0) url(/index_files/img/fon-4november.jpg) no-repeat scroll 0 0 / 100% 100%; z-index: 200; display: block; ">

<script>
if (settedlang != 'ru') {
	//jQuery('#overlays').css("background","rgba(0, 0, 0, 0) url('/index_files/img/dnevnik.jpg') repeat scroll 0 0 / 100% auto");
	//jQuery('#overlays').css("background","rgba(0, 0, 0, 0) url('/index_files/img/fon-4november.jpg') no-repeat scroll 0 0 / 100% 100%");
	//jQuery('#overlays').css("background","rgba(0, 0, 0, 0) url('/index_files/img/fon-7november.jpg') no-repeat scroll 0 0 / 100% 100%");

	//jQuery('#overlays').css("background","rgba(0, 0, 0, 0) url('/index_files/img/fon-11november.jpg') no-repeat scroll 0 0 / 100% 100%");

// /index_files/img/fon.gif 
// url(/index_files/img/fon-paris4.jpg) repeat scroll 0 0;

}
</script>

<div id="descriptionDialog" style="min-height: 100px; left: 1090px; display: block;">
<div onclick="createCookie(&#39;showhelp&#39;,&#39;closed&#39;,999);$(&#39;#showhelp&#39;).show();$(&#39;#descriptionDialog&#39;).hide();" style="display:none;color:red;font-family:&#39;Comic Sans MS&#39;;font-size:27px;font-weight:bold;position:absolute;right:25px;  top:18px;cursor:pointer;">X</div>
<div id="modedesc" style="display: none;"><span id="onlinerightmars"></span></div>
<div id="maindesc" style="display: none;">

<div style="text-align:center;"><h1 style="margin-top:10px;">Чашка Петри</h1></div>


<!--a href="http://web.archive.org/web/20151227050543/https://vk.com/petridish_pw?w=wall-97324915_152977" target="_blank"--><img src="./index_files/img/friday.png" height="0" width="0" alt=""></a>


<script type="text/javascript" src="./index_files/openapi.js"></script>

<!-- VK Widget -->
<!-- div id="vk_groups" style="height: 140px; width: 260px; background: none;"><iframe name="fXD49bac" frameborder="0" src="./index_files/widget_community.html" width="260" height="200" scrolling="no" id="vkwidget1" style="overflow: hidden; height: 140px;"></iframe></div>
<script type="text/javascript">
VK.Widgets.Group("vk_groups", {mode: 1, width: "260", height: "400", color1: 'FFFFFF', color2: '2B587A', color3: '5B7FA6'}, 97324915);
</script -->





<div style="text-align:center;"><h2>Управление в игре Петри Диш</h2></div>

<strong>W</strong> - стрелять или кормить<br><strong>Пробел </strong>- разделиться<br><strong>Esc </strong>- меню<br><strong>F11 </strong>- полный экран<br><strong>E </strong>- включить/выключить компас<br><strong>F </strong>- пауза вкл/выкл<br><strong>←↑→↓ / либо клик мышкой </strong>- <br>(в режиме зрителя) навигация по карте
</div>









<div onclick="$(&#39;#maindesc&#39;).show();$(&#39;#hidemodedesc&#39;).hide();$(&#39;#modedesc&#39;).hide();" id="hidemodedesc" style="margin-top:20px;display:none;text-align:center;"><a style="text-align:center;border-bottom:1px dashed;cursor:pointer;">Убрать описание режима</a></div>

<button title="" alt="" style="margin-left: 0px; display: none;" type="submit" id="playBtn" onclick="playbtnclick();" class="btn btn-play btn-primary btn-needs-server">Играть</button>

<button class="btn btn-warning btn-spectate btn-needs-server" onclick="spectatebtnclick();" id="spectateBtn" style="display: block;">Наблюдать</button>

<div id="slotsstatus" style="display:none;clear:both;margin-top:10px;text-align:center;">Слотов нет. Зайти нельзя.</div>

</div>

<div id="helloDialog" style="min-height:615px;">

<div id="spacer" style="height:11px;"></div>

<form role="form">
<div class="form-group" style="margin-bottom:5px;">



<div style="margin-top:15px;margin-bottom:-20px;"><center>
<!--a href="http://web.archive.org/web/20151227050543/http://vk.com/petridish_pw" target="_blank">Розыгрыш скинов!</a --></center></div>



<h2>
<a href="#" style="display: block;margin-top: 30px;">
<center style="font-family: Lobster;font-size: 40px;">
Ogar</center>
</a>
</h2>



<div class="text-muted text-center" id="clientstatus" style="margin-bottom: 10px;">
Всего игроков онлайн: <span id="onlinetotal">NaN</span>

</div>

</div>
<div class="form-group">
<input style="float:left;margin-left:50px; margin-right:0px; width:370px;" value="" onchange="" id="nick" class="form-control" placeholder="Ник" maxlength="15">

<input style="float:left;display:none;margin-left:0px; width:370px;" value="" type="password" id="password" class="form-control" placeholder="Пароль" maxlength="10">

<select id="color" class="form-control" required="" style="float:right;display:none; width: 80px; padding-right: 5px; padding-left: 7px;margin-right:47px; position: absolute; opacity: 0; pointer-events: none;">
<option value="0" style="color:red;">Красный</option>
<option value="1" style="color:green;">Зеленый</option>
<option value="2" style="color:blue;">Синий</option>
<option selected="selected" value="3" style="color:black;">Цвет</option>

</select>



<div style="clear:both;height:1px;">&nbsp;</div>

<div id="hint" style="display:none;color:red;margin-bottom:-8px;margin-top:8px;" class="text-muted text-center">Для этого ника требуется пароль.</div>
<div id="clanhint" style="display:none;color:red;margin-bottom:-8px;margin-top:8px;" class="text-muted text-center">Для этого клана требуется пароль. </div>
<div style="clear:both;height:1px;">&nbsp;</div>




<div style="clear:both;height:1px;">&nbsp;</div>




</div>



<div style="clear:both;height:1px;">&nbsp;</div>
<div class="form-group">
<div id="locationKnown">



<div id="modeselector" style="float:left;">
<center>

<!--button description="В этом разделе представлены Клан-Хаусы - сервера, принадлежащие кланам. Кланы сами управляют своими серверами, могут выбирать себе режим FFA или Experimental, могут закрыть свой сервер паролем." id="CLANHOUSE" onclick="createCookie(&#39;selectedmode&#39;,&#39;CLANHOUSE&#39;,999);showonly(&#39;CLANHOUSE&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">ClanHouse</button><br-->

<button description="Базовый режим. Поедай корм, чтобы расти и есть других игроков. Зелёные вирусы разобьют тебя на несколько частей. В этом режиме представлено наибольшее количество серверов, включая гигантские сервера на 300, 400 и 700 слотов! Места хватит всем! Размер корма на серверах разный, от 1 до 3. На сервере Сибирь размер еды - случайный. Размер одного шара в игре ограничен 22500 единицами массы." id="FFA" onclick="createCookie(&#39;selectedmode&#39;,&#39;FFA&#39;,999);showonly(&#39;FFA&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode btn-success" style="margin-bottom: 1px;">FFA</button><br>

<button description="В этом режиме еда очень большая - по 5 единиц сразу, размер одного шара увеличен до 32500 единиц. Все карты увеличенного размера. Режим отличается огромной массой игроков и очень динамичной игрой, при которой есть риск сломать клавишу W и пробел." id="FASTFOOD" onclick="createCookie(&#39;selectedmode&#39;,&#39;FASTFOOD&#39;,999);showonly(&#39;FASTFOOD&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">FastFood FFA</button><br>

<img style="margin-top:-4px;position:absolute;" src="./index_files/img/label_newred.png" alt="New mode!!!"><button description="Это самые хардкорные сервера в Чашке Петри. Еда разного калибра от 1 до 50. Скорости бешеные. Вы точно уверены, что сможете здесь выжить?" id="HARDCORE" onclick="createCookie(&#39;selectedmode&#39;,&#39;HARDCORE&#39;,999);showonly(&#39;HARDCORE&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">HardCore FFA</button><br>

<img style="margin-top:-4px;position:absolute;" src="./index_files/img/label_newred.png" alt="New mode!!!"><button description="Это то, чего вы так давно ждали и просили - сервера с мгновенным соединением после сплита! И делиться можно на десятки клеток! Безумие! (Да, может лагать графика)" id="MEGASPLIT" onclick="createCookie(&#39;selectedmode&#39;,&#39;MEGASPLIT&#39;,999);showonly(&#39;MEGASPLIT&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">MegaSplit FFA</button><br>

<button description="Борьба между тремя командами: зелёными, красными и синими. Перед игрой можно выбрать свой цвет. Во время игры поменять имя и команду невозможно. В нашем варианте игроки своей команды не мешают пройти друг другу." id="TEAM" onclick="createCookie(&#39;selectedmode&#39;,&#39;TEAM&#39;,999);showonly(&#39;TEAM&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">TEAM</button><br>

<button description="Экспериментальный - режим, похожий на FFA, только с добавлением больших красных вирусов-кормушек. А обычные вирусы в этом режиме можно толкать, стреляя в них массой W." id="EXPERIMENTAL" onclick="createCookie(&#39;selectedmode&#39;,&#39;EXPERIMENTAL&#39;,999);showonly(&#39;EXPERIMENTAL&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">EXPERIMENTAL</button><br>

<img style="margin-top:-4px;position:absolute;" src="./index_files/img/label_newred.png" alt="New mode!!!"><button description="Это самые хардкорные сервера в Чашке Петри. Еда разного калибра от 1 до 50. Скорости бешеные. Вы точно уверены, что сможете здесь выжить?" id="HARDCOREEXP" onclick="createCookie(&#39;selectedmode&#39;,&#39;HARDCOREEXP&#39;,999);showonly(&#39;HARDCOREEXP&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">HardCore EXP</button><br>

<!--button description="На аренах каждый сам за себя и у каждого есть только 1 жизнь. Если ты проиграл - жди конца раунда и присоединяйся к новой партии. Но если уж выиграл - так всё, поздравляем! &lt;br/&gt;&lt;br/&gt; В этом режиме есть одна карта увеличенного размера (4К) - это первая карта, а все остальные карты - маленького размера (2.5К). Если до начала раунда не наберётся необходимое количество игроков, сервер добавит в игру злых и агрессивных ботов! &lt;br/&gt;&lt;br/&gt; Внимание! В этом режиме запрещена командная игра, договоренная заранее!" id="ARENA" onclick="createCookie(&#39;selectedmode&#39;,&#39;ARENA&#39;,999);showonly(&#39;ARENA&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">ARENA</button><br>

<button description="Это особый вариант Арены. Маленькая карта. 8 игроков. Стартовая масса 1004 единицы. Всего 1 жизнь. И только 1 победитель. &lt;br/&gt;&lt;br/&gt; Внимание! В этом режиме запрещена командная игра, договоренная заранее!" id="FATBOY-ARENA" onclick="createCookie(&#39;selectedmode&#39;,&#39;FATBOY-ARENA&#39;,999);showonly(&#39;FATBOY-ARENA&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">FATBOY ARENA</button><br-->

<button description="Это безумная и сумасшедшая вариация классического FFA-режима. На этих серверах масса, которую вы отстреливаете через W, не кормит, а отнимает вес у противников! Все игроки начинают с 400 единицами массы." id="CRAZY-FFA" onclick="createCookie(&#39;selectedmode&#39;,&#39;CRAZY-FFA&#39;,999);showonly(&#39;CRAZY-FFA&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">CRAZY FFA</button><br>

<img style="margin-top:-4px;position:absolute;" src="./index_files/img/label_newred.png" alt="New mode!!!"><button description="Бета-тест нового режима. Пофидить вирус нужно всего 1 раз! Обалдеть просто... " id="ONESHOT" onclick="createCookie(&#39;selectedmode&#39;,&#39;ONESHOT&#39;,999);showonly(&#39;ONESHOT&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">OneShot</button><br>

<img style="margin-top:-4px;position:absolute;" src="./index_files/img/label_newred.png" alt="New mode!!!"><button description="Новый режим. Разделения заменены на скачки... " id="LEAP" onclick="createCookie(&#39;selectedmode&#39;,&#39;LEAP&#39;,999);showonly(&#39;LEAP&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">Leap</button><br>

<img style="margin-top:-4px;position:absolute;" src="./index_files/img/label_newred.png" alt="New mode!!!"><button description="Новый режим. Боты стали гораздо агрессивнее и играют в одной команде, сможешь ли ты выстаять перед ними? " id="BOTSTEAM" onclick="createCookie(&#39;selectedmode&#39;,&#39;BOTSTEAM&#39;,999);showonly(&#39;BOTSTEAM&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">BotsTeam</button><br>

<button description="В этом режиме невозможно съесть другого игрока. Его можно только застрелить, используя ваши патроны W. И вирусы тут не страшны вам - теперь это ваша защита от пуль. Рейтинг топ-10 считается по количеству убитых шаров противника (фрагов). Все игроки начинают с 700 единицами массы. В этом режиме вы можете разделиться максимум на 4 части." id="DEATHMATCH" onclick="createCookie(&#39;selectedmode&#39;,&#39;DEATHMATCH&#39;,999);showonly(&#39;DEATHMATCH&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">DEATHMATCH</button><br>

<!--button description="Один из самых сложных режимов в Чашке Петри. В начале раунда выбирается один зомби. Задача зомби - поработить как можно больше людей, прикоснувшись к ним. Задача людей - одержать победу в этой схватке. На карте присутствуют бустеры, которые помогут в этой игре - «Hero» (получить его может только человек), дающий возможность съесть зомби или вылечиться от заражения (пока не стал окончательно зомби), и бустер «Brain» - дающий зомби суперскорость. Если зомби съест бустер «Hero», то он умрёт. Рекомендуется играть в этом режиме либо без скинов, либо выключив простой рендер, иначе вам будет трудно отличать команды зомби от людей." id="ZOMBIE-FFA" onclick="createCookie(&#39;selectedmode&#39;,&#39;ZOMBIE-FFA&#39;,999);showonly(&#39;ZOMBIE-FFA&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">ZOMBIE</button><br-->

<button description="Можно стрелять вирусами, нажав клавишу V! Минимум надо иметь разное количество массы, от 200 до 500, это зависит от сервера. При стрельбе отнимается от 150 до 450 массы, зависит от сервера - смотрите на название сервера. При поедании вируса массы не прибавляется! Делиться можно на 32 части! Скорость сборки после деления ускорена в 3 раза! А так - это как обычный ФФА-режим!" id="VIRUSWARSFFA" onclick="createCookie(&#39;selectedmode&#39;,&#39;VIRUSWARSFFA&#39;,999);showonly(&#39;VIRUSWARSFFA&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">Virus Wars FFA</button><br>

<button description="В этом разделе представлены Клан-Хаусы - сервера, принадлежащие кланам. Кланы сами управляют своими серверами, могут выбирать себе режим FFA или Experimental, могут закрыть свой сервер паролем." id="CLANHOUSE" onclick="createCookie(&#39;selectedmode&#39;,&#39;CLANHOUSE&#39;,999);showonly(&#39;CLANHOUSE&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">CLANHOUSE</button><br>

<button description="Новый режим! Змейки в Чашке Петри! Используй Q, чтобы ускоряться! Используй пробел, чтобы делиться и напрыгивать на соперника! Остерегайся зелёных вирусов, которые разобьют тебя на части и превратят в лёгкую добычу! Стань самым прожорливым! Захвати топ!" id="SNAKERDISH" onclick="createCookie(&#39;selectedmode&#39;,&#39;SNAKERDISH&#39;,999);showonly(&#39;SNAKERDISH&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">SnakerDish</button><br>

<!--button description="Этот режим - как ФФА, только здесь нужно кормить чёрную дыру, чтобы быть в топе! Кормить можно как пробелом, так и через W.  &lt;br/&gt; &lt;br/&gt;Умирать нельзя - очки сгорают.  &lt;br/&gt; &lt;br/&gt;FIXED - это сервера, где Чёрная дыра стоит на месте.  &lt;br/&gt; &lt;br/&gt;MOVING - это сервера, где она двигается." id="BLACKHOLE" onclick="createCookie(&#39;selectedmode&#39;,&#39;BLACKHOLE&#39;,999);showonly(&#39;BLACKHOLE&#39;);$(this).toggleClass(&#39;btn-success&#39;);return false;" class="btn btn-primary btn-gamemode" style="margin-bottom: 1px;">Black Hole</button-->




</center>
</div>



<script>
var isAdmin = false;;

function serverchange() { 
	$('#playBtn').show();
	if (playerGroup.length == 0) {
		$('#spectateBtn').show();
	}
}


function settingsclick() { 
	if ($("#settingsDialog").is(":visible") == true) {
		//console.log("a 1");
		jQuery('#opts, #langs, #settingsDialog').hide();
		jQuery('#settingsDialog').css("z-index","0");
		return;
	}
	if ($("#settingsDialog").is(":visible") == false) {
		//console.log("a 2");
		jQuery('#opts, #langs, #settingsDialog').show();
		jQuery('#settingsDialog').css("z-index","2");
		return;
	}
}




</script>


<script>

var server_stats;

setTimeout(function(){updateStats();},0)
setInterval(function(){
	updateStats();
},1000)

function updateStats(){
	OnGameStart();
	$.get("/stats",function(q){
		try{server_stats = JSON.parse(q);} catch(e){};
	});
	var size = 0;
	var server_online = 0;
	for(var key in server_stats){
		size++
		server_online+=server_stats[key].players;
	}
	onlinetotal.innerHTML = server_online;
	try{
		for(var i=0;i<size;i++){
			try{
				var online = document.getElementById("S"+i).innerHTML.split("/")[0].split(" ")[document.getElementById("S"+i).innerHTML.split("/")[0].split(" ").length-1];
				var maxplayers = document.getElementById("S"+i).innerHTML.split("/")[1].split(" ")[0];
				document.getElementById("S"+i).innerHTML=document.getElementById("S"+i).innerHTML.split(online+"/"+maxplayers)[0]+server_stats[i].players+"/"+server_stats[i].max+document.getElementById("S"+i).innerHTML.split(online+"/"+maxplayers)[1]
				document.getElementById("S"+i).setAttribute("online", server_stats[i].players);
				document.getElementById("S"+i).setAttribute("connectlimit", server_stats[i].max);
			} catch(e){};
		}
	} catch(e){};
}
</script>

<div id="serverselector" style="float:right;">

<input style="display:none;margin-bottom:14px; width:275px;" value="" type="password" id="serverpassword" class="form-control" placeholder="Пароль для кланхауса" maxlength="15">

<select size="19" style="width: 275px; margin-right: 28px;" id="region" class="form-control" onchange="serverchange();" required="">
<option class="Russia" id="S0" autorun="FServer1" stats="FServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="160" mode="FFA" map="18K" food="3" value="127.0.0.1:602">#1: Server1 - Еда3 - NaN/160 игроков</option>
<option class="Russia" id="S1" autorun="HServer1" stats="HServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="HARDCORE" map="12K" food="1-50" value="127.0.0.1:603">#1: Server1 - Еда1-50 - NaN/64 игроков</option>
<option class="Russia" id="S2" autorun="MServer1" stats="MServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="MEGASPLIT" map="12K" food="3" value="127.0.0.1:604">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S3" autorun="EServer1" stats="EServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="EXPERIMENTAL" map="12K" food="3" value="127.0.0.1:605">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S4" autorun="TServer1" stats="TServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="TEAM" map="12K" food="3" value="127.0.0.1:606">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S5" autorun="HEServer1" stats="HEServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="HARDCOREEXP" map="12K" food="3" value="127.0.0.1:607">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S6" autorun="FFServer1" stats="FFServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="FASTFOOD" map="12K" food="5" value="127.0.0.1:608">#1: Server1 - Еда5 - NaN/64 игроков</option>
<option class="Russia" id="S7" autorun="CFServer1" stats="CFServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="CRAZY-FFA" map="12K" food="3" value="127.0.0.1:609">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S8" autorun="OSServer1" stats="OSServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="ONESHOT" map="12K" food="3" value="127.0.0.1:610">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S9" autorun="LServer1" stats="LServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="LEAP" map="12K" food="3" value="127.0.0.1:611">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S10" autorun="BTServer1" stats="BTServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="BOTSTEAM" map="12K" food="3" value="127.0.0.1:612">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S11" autorun="VWServer1" stats="VWServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="VIRUSWARSFFA" map="12K" food="3" value="127.0.0.1:613">#1: Virus-200 - NaN/64 игроков</option>
<option class="Russia" id="S12" autorun="DMServer1" stats="DMServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="DEATHMATCH" map="6K" food="3" value="127.0.0.1:614">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S13" autorun="CHServer1" stats="CHServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="CLANHOUSE" map="6K" food="3" value="127.0.0.1:615">#1: Server1 - Еда3 - NaN/64 игроков</option>
<option class="Russia" id="S14" autorun="SDServer1" stats="SDServer1" descr="Server1" location="Russia" onclick="showhint(this);" sname="Server1 - " modenumber="1" online="NaN" connectlimit="64" mode="SNAKERDISH" map="12K" food="3" value="127.0.0.1:616">#1: Server1 - Еда3 - NaN/64 игроков</option>
</select>

<div id="rotator"><a href="http://donate.petridish.pw/skin" target="_blank" title=""><img src="./index_files/img/chashka-nick.png" style="margin-top:10px;" alt=""></a></div>

</div>
		

</div>

<div style="clear:both;">

<div style="clear:both;height:1px;">&nbsp;</div>

<div style="clear:both;height:1px;">&nbsp;</div>

</div>

</div>







</form>




<div id="bottomlinks">
<center>
</center>
</div>

<br clear="all">





<center>
<a target="_parent" title="Сохранить в Вконтакте" onclick="window.open(this.href, this.title, `toolbar=0, status=0, width=548, height=325`); return false" href="http://vkontakte.ru/share.php?url=http://petridish.pw&amp;title=%D0%97%D0%B0%D1%88%D0%B5%D0%BB%20%D1%81%D1%8E%D0%B4%D0%B0%20%D0%BD%D0%B0%205%20%D0%BC%D0%B8%D0%BD%D1%83%D1%82%D0%BE%D0%BA%20%D0%B8%20%D0%BD%D0%B5%20%D0%BC%D0%BE%D0%B3%D1%83%20%D0%BE%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D1%8C%D1%81%D1%8F.%20%D0%9F%D0%BE%D0%BC%D0%BE%D0%B3%D0%B8%D1%82%D0%B5!%20&amp;description=%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5,%20%D0%BA%D0%B0%D0%BA%D1%83%D1%8E%20%D0%B8%D0%B3%D1%80%D1%83%20%D0%BD%D0%B0%D1%88%D0%B5%D0%BB:%20http://petridish.pw&amp;image=http://petridish.pw/petri.jpg&amp;noparse=true"><img title="Сохранить в Вконтакте" alt="Сохранить в Вконтакте" src="./index_files/img/vk.png" style="margin-right:10px;" width="36"></a><a target="_parent" title="Поделиться ссылкой в Фейсбуке" onclick="window.open(this.href, this.title, `toolbar=0, status=0, width=548, height=325`); return false" href="http://www.facebook.com/sharer.php?s=100&amp;p[url]=http://petridish.pw&amp;p[title]=%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5!%20&amp;p[summary]=%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5,%20%D0%BA%D0%B0%D0%BA%D1%83%D1%8E%20%D0%B8%D0%B3%D1%80%D1%83%20%D0%BD%D0%B0%D1%88%D0%B5%D0%BB:%20http://petridish.pw&amp;p[images][0]=http://petridish.pw/petri.jpg"><img title="Поделиться ссылкой в Фейсбуке" alt="Поделиться ссылкой в Фейсбуке" src="./index_files/img/fb.png" style="margin-right:10px;" width="36"></a><a title="Поделиться ссылкой в Твиттере" target="_parent" onclick="window.open(this.href, this.title, `toolbar=0, status=0, width=548, height=325`); return false" href="http://twitter.com/share?text=%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5,%20%D0%BA%D0%B0%D0%BA%D1%83%D1%8E%20%D0%B8%D0%B3%D1%80%D1%83%20%D0%BD%D0%B0%D1%88%D0%B5%D0%BB!&amp;hashtags=petridish,agar,agario&amp;url=http://petridish.pw"><img title="Поделиться ссылкой в Твиттере" alt="Поделиться ссылкой в Твиттере" src="./index_files/img/tw.png" style="margin-right:0px;" width="36"></a>
</center>



















<br clear="all">
<div style="clear:both;height:20px;">&nbsp;</div>


</div>

<div id="donatewindow" style="right: 790px;">


<center>
<script type="text/javascript" src="//vk.com/js/api/openapi.js?121"></script>

<!-- VK Widget -->
<div id="vk_groups"></div>
<script type="text/javascript">
VK.Widgets.Group("vk_groups", {mode: 0, width: "220", height: "400", color1: 'FFFFFF', color2: '2B587A', color3: '5B7FA6'}, 55536779);
</script>
</center>







</div>




<div id="settingsDialog" style="min-height: 500px; left: 1090px; display: none;">

<div id="opts" style="display:none; clear:both; margin: -10px 6px 6px;">


<h3 id="gamesettings">Настройки игры</h3>

<input type="checkbox" id="setskins" onchange="createCookie(&#39;setskins&#39;,!$(&#39;#setskins&#39;).is(&#39;:checked&#39;),999);setSkins(!$(this).is(&#39;:checked&#39;));"><label> Без скинов</label><br>

<input type="checkbox" id="setnames" onchange="createCookie(&#39;setnames&#39;,!$(&#39;#setnames&#39;).is(&#39;:checked&#39;),999);setNames(!$(this).is(&#39;:checked&#39;));"><label> Без ников</label><br>

<input type="checkbox" id="setdark" onchange="createCookie(&#39;setdark&#39;,$(&#39;#setdark&#39;).is(&#39;:checked&#39;),999);setDarkTheme($(this).is(&#39;:checked&#39;));"><label> Ночной режим</label><br>

<input type="checkbox" id="setcolors" onchange="createCookie(&#39;setcolors&#39;,$(&#39;#setcolors&#39;).is(&#39;:checked&#39;),999);setColorsOff($(this).is(&#39;:checked&#39;));"><label> Игроки одного цвета</label><br>

<input type="checkbox" id="setmass" onchange="createCookie(&#39;setmass&#39;,$(&#39;#setmass&#39;).is(&#39;:checked&#39;),999);setShowMass($(this).is(&#39;:checked&#39;));" checked=""><label> Показать массу</label><br>

<input type="checkbox" id="largeborders" onchange="createCookie(&#39;largeborders&#39;,$(&#39;#largeborders&#39;).is(&#39;:checked&#39;),999);setLargeBlobBorders($(this).is(&#39;:checked&#39;));"><label> Толстые края шаров</label><br>

<input type="checkbox" id="largenames" onchange="createCookie(&#39;largenames&#39;,$(&#39;#largenames&#39;).is(&#39;:checked&#39;),999);setLargeNames($(this).is(&#39;:checked&#39;));"><label> Большой шрифт ников</label><br>

<input type="checkbox" id="setacid" onchange="createCookie(&#39;setacid&#39;,$(&#39;#setacid&#39;).is(&#39;:checked&#39;),999);setAcid($(this).is(&#39;:checked&#39;));"><label> Кислота</label><br>

<input type="checkbox" id="setrealtimestats" onchange="createCookie(&#39;setrealtimestats&#39;,$(&#39;#setrealtimestats&#39;).is(&#39;:checked&#39;),999);OnChangeDisplayStats($(this).is(&#39;:checked&#39;));"><label> Статистика во время игры</label><br>



<h3 id="perfsettings">Производительность</h3>
<input type="checkbox" id="simplerenderbutton" onchange="createCookie(&#39;simplerenderbutton&#39;,$(&#39;#simplerenderbutton&#39;).is(&#39;:checked&#39;),999);setSimpleMode($(this).is(&#39;:checked&#39;));" checked="checked"><label> Простой рендер</label>
<br>
<input type="checkbox" id="hidegrid" onchange="createCookie(&#39;hidegrid&#39;,$(&#39;#hidegrid&#39;).is(&#39;:checked&#39;),999);setHideGrid($(this).is(&#39;:checked&#39;));"><label> Убрать клеточки</label>
<br>


<h3 id="chatsettings">Настройки чата</h3>
<input type="checkbox" id="chatenter" onchange="createCookie(&#39;chatenter&#39;,$(&#39;#chatenter&#39;).is(&#39;:checked&#39;),999);checkchatenter();"><label> Показывать входы в игру</label><br>
<input type="checkbox" id="ruschat" onchange="createCookie(&#39;ruschat&#39;,$(&#39;#ruschat&#39;).is(&#39;:checked&#39;),999);checkruschat();" checked="checked"><label> Смотреть русский чат</label><br>
<input type="checkbox" id="engchat" onchange="createCookie(&#39;engchat&#39;,$(&#39;#engchat&#39;).is(&#39;:checked&#39;),999);checkengchat();" checked="checked"><label> Смотреть англоязычный чат</label><br>
<input type="checkbox" id="frchat" onchange="createCookie(&#39;frchat&#39;,$(&#39;#frchat&#39;).is(&#39;:checked&#39;),999);checkfrchat();" checked="checked"><label> Смотреть франкоязычный чат</label><br>

<input type="checkbox" id="scrollchat" onchange="createCookie(&#39;scrollchat&#39;,$(&#39;#scrollchat&#39;).is(&#39;:checked&#39;),999);checkchatscroll();"><label> Прокрутка в чате</label><br>

</div>

</div>


<div id="toplangss" style="margin-right: 15px;margin-top:15px;position:absolute;top:0px;right:0px;background:white none repeat scroll 0 0;border-radius:25px;box-shadow:0 0 26px -2px rgba(0, 0, 0, 0.9);padding: 6px 11px 6px;">

<img onclick="settingsclick();return false;" style="margin-left:5px;margin-right:10px;cursor:pointer;" src="./index_files/img/settings2.png" width="32" alt="" title="">

<a onclick="createCookie(&#39;lang&#39;,&#39;ru&#39;,999);" href="./index_files/index.html" title=""><img style="cursor:pointer;" src="./index_files/img/ru.png" width="32" alt="" title=""></a>
<a onclick="createCookie(&#39;lang&#39;,&#39;en&#39;,999);" href="http://web.archive.org/web/20151227050543/http://petridish.pw/en/" title=""><img style="cursor:pointer;" src="./index_files/img/uk.png" width="32" alt="" title=""></a>
<a onclick="createCookie(&#39;lang&#39;,&#39;fr&#39;,999);" href="http://web.archive.org/web/20151227050543/http://petridish.pw/fr/" title=""><img style="cursor:pointer;" src="./index_files/img/fr.png" width="32" alt="" title=""></a>
</div>




<div id="statssmall" onclick="$(&#39;#stats,#serverstats&#39;).show();$(&#39;#helloDialog&#39;).hide();$(&#39;#descriptionDialog&#39;).hide();DrawStats();$(this).hide();" class="btn btn-primary" style="display: none; z-index: 7; position: absolute; top: 0px; left: 620px;">Game over. View game statistics...</div>









<div id="stats" style="display: none; z-index: 11; position: absolute; top: 50%; left: 50%; margin-right: -50%; transform: translate(-50%, -50%); width: 450px; border-radius: 15px; padding: 5px 15px; background-color: rgb(255, 255, 255);"><div title="Close stats" style="color:red;cursor:pointer;font-family:verdana;font-size:30px;font-weight:bold;position:absolute;right:13px;" id="closestats" onclick="$(&#39;#stats,#serverstats&#39;).hide();jQuery(&#39;#descriptionDialog&#39;).show();jQuery(&#39;#helloDialog&#39;).show();$(&#39;#statssmall&#39;).show();"><img src="./index_files/img/stats-close.gif"></div><div id="statArea" style="vertical-align:top;margin-top:10px;"></div><div id="pieArea" style="float:right;vertical-align:top;margin-top:20px;width:190px; height:226px; display:inline-block; vertical-align:top"> </div><div id="gainArea" style="float:left;margin-top:10px;width:225px; display:inline-block; vertical-align:top"></div><div id="lossArea" style="float:left;margin-top:10px;width:225px; display:inline-block;"></div><div id="chartArea" style="display:none;display:inline-block; vertical-align:top"></div><div id="buttonsArea" style="clear:both;vertical-align:top;margin-top:10px;margin-bottom:10px;"><button title="" alt="" style="margin-right:20px;margin-left:0px;width:175px;display:inline-block;" type="submit" id="statplayBtn" onclick="playbtnclick();" class="btn btn-play btn-primary btn-needs-server">Сыграть ещё!</button><button title="" alt="" style="margin-left:0px; width:175px;display:inline-block;" type="submit" id="statmenuBtn" onclick="jQuery(&#39;#stats,#serverstats&#39;).hide();jQuery(&#39;#statssmall&#39;).show();jQuery(&#39;#descriptionDialog&#39;).show();jQuery(&#39;#helloDialog&#39;).show();return false;" class="btn btn-play btn-primary btn-needs-server">Главное меню</button><img src="./index_files/img/stats-spectate.gif" style="cursor:pointer;margin-top:13px;margin-left:13px;" alt="Войти в режиме наблюдателя" title="Войти в режиме наблюдателя" onclick="spectatebtnclick();"></div></div>



<div id="serverstats" style="display: none; z-index: 12; position: absolute; top: 50%; left: 1090px; margin-right: -50%; transform: translate(-50%, -50%); width: 330px; min-height: 450px; max-height: 560px; border-radius: 15px; padding: 5px 15px; overflow-y: auto; background-color: rgb(255, 255, 255);"><h1>Статистика сервера</h1><div id="sername"></div><div id="statsinterval" style="text-align:center;"><div id="inttoday" class="interval active" onclick="loadstats(&#39;today&#39;,true);">Сегодня</div><div id="intyesterday" class="interval" onclick="loadstats(&#39;yesterday&#39;);">Вчера</div><div id="inttwodays" class="interval" onclick="loadstats(&#39;twodays&#39;);">Позавчера</div><div id="intalltime" class="interval" onclick="loadstats(&#39;alltime&#39;);">За всё время</div></div><div id="statshere"><div id="statstoday" class="actualstats"></div><div id="statsyesterday" class="actualstats"></div><div id="statstwodays" class="actualstats"></div><div id="statsalltime" class="actualstats"></div></div><a href="http://web.archive.org/web/20151227050543/http://donate.petridish.pw/stats" target="_blank"><img src="./index_files/img/top.png" width="295"></a></div>


<script>
var titlet = 'Результат игры';
var gametimet = 'Время игры:';
var hight = 'Набрал массы:';
var lbmaxt = 'Место в топе:';
var nopet = "не попал";
var topgt = 'Топ жертв';
var toplt = 'Топ жрунов';
var noeatt = "Вы никого не съели";
var noeatyout = 'Вас никто не съедал';
var masst = 'массы';
var pelletst = 'еды';
var cellst = 'клеток';
var virusest = 'вирусов';
var statst = 'Статистика';
var showallt = 'Показать всех';

</script>



</div>


<div id="servermsg" style="display:none; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 9999;"></div>

<div id="connecting" style="display:none; position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 100; background-color: rgba(0, 0, 0, 0.5); display: none;">
<div style="width: 350px; background-color: #FFFFFF; margin: 100px auto; border-radius: 15px; padding: 5px 15px 5px 15px;">
</div>
</div>

<canvas id="canvas" width="764" height="455"></canvas>
	
<input type="text" maxlength="190" id="chat_textbox" placeholder="Нажми ЕНТЕР, чтобы писать">

<div id="chatlog" class="whitechat" style="overflow-y: hidden;">
<div class="chatwelcome">
Добро пожаловать в Чашку Петри!</div>
</div>

<div id="kompas" style="left: 537px; opacity: 0.2;">
<span>X</span><input type="text" maxlength="5" id="kompasx" onchange="runkompas();">
<span>Y</span><input type="text" maxlength="5" id="kompasy" onchange="runkompas();">
<img src="./index_files/img/shoot-on.png" width="26" style="cursor:pointer;margin-top:-7px;display:none;" id="shooton" onclick="shootonn();" alt="">
<img src="./index_files/img/shoot-off.png" width="26" style="cursor:pointer;margin-top:-7px;" id="shootoff" onclick="shootofff();" alt="">
</div>


<script>

function shootonn() {
	$("#shooton").hide();
	$("#shootoff").show();
	$("#kompas").css("opacity","0.2");
	isTargeting = false;
}

function shootofff() {
	$("#shooton").show();
	$("#shootoff").hide();
	$("#kompas").css("opacity","1");
	isTargeting = true;
}

function runkompas() {
	targetBufferX = parseInt($("#kompasx").val(),10);
	targetBufferY = parseInt($("#kompasy").val(),10);
	if (targetBufferX > mapmaxX) { targetBufferX = mapmaxX;$("#kompasx").val(targetBufferX); }
	if (targetBufferY > mapmaxY) { targetBufferY = mapmaxY;$("#kompasy").val(targetBufferY); }
	if (targetBufferX < 0) { targetBufferX = 0;$("#kompasx").val(targetBufferX); }
	if (targetBufferY < 0) { targetBufferY = 0;$("#kompasy").val(targetBufferY); }
}



</script>





<div style="font-family:&#39;Ubuntu&#39;">&nbsp;</div>






<button style="display:none;width:150px;position:absolute;z-index:1000;top:0;left:0;" id="showhelp" onclick="createCookie(&#39;showhelp&#39;,&#39;open&#39;,999);$(&#39;#descriptionDialog&#39;).show();$(this).hide()" class="btn btn-primary">Открыть помощь</button>

<button style="display:none;width:175px;position:absolute;z-index:199;top:0;left:150px;" id="chatlogshow" onclick="$(&#39;#chatlog&#39;).show();$(&#39;#chat_textbox&#39;).show();$(&#39;#chatloghide&#39;).show();$(this).hide()" class="btn btn-primary">Открыть чат сервера</button>
<button style="width:175px;position:absolute;z-index:199;top:0;left:150px;" id="chatloghide" onclick="$(&#39;#chatlog&#39;).hide();$(&#39;#chat_textbox&#39;).hide();$(&#39;#chatlogshow&#39;).show();$(this).hide()" class="btn btn-primary">Закрыть чат сервера</button>
<button style="width:175px;position:absolute;z-index:199;top:0;right:275px;outline: 0;display: none;" onkeydown="return false;" id="adminbtn" style="display: none;" onclick="adminka.offsetHeight ? $(adminka).hide() : $(adminka).show();" class="btn btn-primary">ADMINKA</button>


<style>
#adminka {
	position: absolute;
	top: 40px;
	left: 10px;
	max-height: 400px;
	overflow: auto;
	z-index: 199;
	background-color: rgba(255,255,255,0.4);
	text-shadow: 0px 0px 1px black;
	font-weight: 900;
	display: none;
}
</style>


<script>
setInterval(function(){
	if(typeof(admindata)!="undefined"&&admindata.update&&isAdmin){
			var msg = new DataView(new ArrayBuffer(2));
			msg.setUint8(0, 72, true);
			msg.setUint8(1, 0, true);
			_socket.send(msg);
			var def = "<table border='2'><tr><td>ID</td><td>Имя</td><td>Шаров</td><td>Масса</td><td>X</td><td>Y</td></tr>";
            var players = admindata.players;
            for(var i=0;i<players.length;i++){
                if (players[i].isAdmin) {
                    def += "<tr style='color: grey;'>";
                } else {
                    def += "<tr>";
                }
                def += "<td>" + players[i].token + "</td><td>" + players[i].name + "</td><td>" + players[i].cells + "</td><td>" + Math.round(players[i].mass) + "</td><td>" + Math.round(players[i].x) + "</td><td>" + Math.round(players[i].y) + "</td><td><a href='#' onclick='admindata.kick(\"" + players[i].token + "\");'>Кик</a></td><td><a href='#' onclick='admindata.ban(\"" + players[i].token + "\");'>Бан</a></td><td><a href='#' onclick='admindata.addmass(\"" + players[i].token + "\");'>+100</a></td><td><a href='#' onclick='admindata.takemass(\"" + players[i].token + "\");'>-100</a></td><td><a href='#' onclick='admindata.kill(\"" + players[i].token + "\");'>Убить</a></td></tr>";
            }
            def += "</table>";
            adminka.innerHTML = def;
		}
},1000)

var _socket = {};
//thisheight = $("#canvas").height() - 70;
//$("#bestchat").height(thisheight);



function startthegame() {
//	passcheck();
	var thisnick = document.getElementById('nick').value;
	if (thisnick.length == 0) { thisnick = "PetriDish.pw"; }
	setNick(thisnick/* + ":::::" + document.getElementById('password').value.toLowerCase() + ":::::" + document.getElementById('color').value*/); 
	setPass(document.getElementById('serverpassword').value.toLowerCase()); 
	createCookie('playername',thisnick,999); 
	createCookie('playerpass',document.getElementById('password').value,999); 
	createCookie('serverpassword',document.getElementById('serverpassword').value,999); 
//	createCookie('simplerenderbutton',document.getElementById('simplerenderbutton').value,999); 

}






var supernames = 'jaguar500070;mexahuk'.replace(/^\uFEFF/, '').split(';');




var superclans = '[a]'.replace(/^\uFEFF/, '').split(';');








var supermods = 'jaguar500070;mexahuk'.replace(/^\uFEFF/, '').split(';');

var superhelpers = ''.split(';');









function passcheck() {
var cleannick = $("#nick").val().toLowerCase().trim();
	for(var i = 0; i < supernames.length; i++) {
	if (supernames[i] != '') {
		if(supernames[i] == cleannick) { 
			$("#password").show().css("width","170px"); 
			$("#nick").css("width","200px"); 
			if (window.selmode == "TEAM") { $("#nick").css("width","200px"); $("#password").css("width","170px"); }
			$("#hint").show();   
			$("#clientstatus").css("margin-bottom","1px");
			return; 
		}
		if(supernames[i] != cleannick) { 
			$("#password").hide(); 
			$("#nick").css("width","370px"); 
			if (window.selmode == "TEAM") { $("#nick").css("width","370px"); }
			$("#hint").hide(); 
			$("#clanhint").hide(); 
		//console.log(supernames[i], $("#nick").val().toLowerCase());
		} 
	}
	}

// basic name check finished 
// now check the clan thing
	for(var b = 0; b < superclans.length; b++) {
		if (superclans[b] != '') {
			var dlinaklana = superclans[b].length;
			var incnick = cleannick;
			if (superclans[b] == incnick.substr(0,dlinaklana)) {
				$("#clientstatus").css("margin-bottom","1px");
				$("#password").show().css("width","170px"); 
				$("#nick").css("width","200px"); 
				if (window.selmode == "TEAM") { $("#nick").css("width","200px"); $("#password").css("width","170px"); }
				$("#clanhint").show();   
				return; 
			}
			if (superclans[b] != incnick.substr(0,dlinaklana)) {
				$("#password").hide(); 
				$("#nick").css("width","370px"); 
				if (window.selmode == "TEAM") { $("#nick").css("width","310px"); }
				$("#clanhint").hide();   
			}
		}
	}
}


function passcheckmd() {

}




function checkchatenter() {
	var chatenter = readCookie("chatenter");
	if (chatenter == null) {
//		createCookie('chatenter',true,999);
//		$("#chatenter").attr("checked","checked");
		$("#chatenter").removeAttr("checked");
		$("#chatlog .chatenter").hide().css("display","none");
	}
	if (chatenter == 'true') {
		$("#chatenter").attr("checked","checked");
		$("#chatlog .chatenter").show().css("display","block");
		$("#chatlog").scrollTop(500000);
	}

	if (chatenter == 'false') {
		$("#chatenter").removeAttr("checked");
		$("#chatlog .chatenter").hide().css("display","none");
	}
}


function checkruschat() {
	var ruschat = readCookie("ruschat");
	if (ruschat == null) {
		createCookie('ruschat',true,999);
		$("#ruschat").attr("checked","checked");
	}
	if (ruschat == 'true') {
		$("#ruschat").attr("checked","checked");
		$("#chatlog .ru").show();
		$("#chatlog").scrollTop(500000);
	}

	if (ruschat == 'false') {
		$("#ruschat").removeAttr("checked");
		$("#chatlog .ru").hide();
	}
}

function checkengchat() {
	var engchat = readCookie("engchat");
	if (engchat == null) {
		createCookie('engchat',true,999);
		$("#engchat").attr("checked","checked");
	}
	if (engchat == 'true') {
		$("#engchat").attr("checked","checked");
		$("#chatlog .en").show();
		$("#chatlog").scrollTop(500000);
	}

	if (engchat == 'false') {
		$("#engchat").removeAttr("checked");
		$("#chatlog .en").hide();
	}
}

function checkfrchat() {
	var frchat = readCookie("frchat");
	if (frchat == null) {
		createCookie('frchat',true,999);
		$("#frchat").attr("checked","checked");
	}
	if (frchat == 'true') {
		$("#frchat").attr("checked","checked");
		$("#chatlog .fr").show();
		$("#chatlog").scrollTop(500000);
	}

	if (frchat == 'false') {
		$("#frchat").removeAttr("checked");
		$("#chatlog .fr").hide();
	}
}




function checkchatscroll() {
	var scrollchats = readCookie("scrollchat");
	if (scrollchats == null) {
		$("#scrollchat").removeAttr("checked");
		$("#chatlog").css("overflow-y","hidden");
	}
	if (scrollchats == 'true') {
		$("#scrollchat").attr("checked","checked");
		$("#chatlog").css("overflow-y","auto");
	}

	if (scrollchats == 'false') {
		$("#scrollchat").removeAttr("checked");
		$("#chatlog").css("overflow-y","hidden");
	}
}


function checkhelp() {
	var showhelps = readCookie("showhelp");
	if (showhelps == 'closed') {
		$('#showhelp').show();
		$('#descriptionDialog').hide();
	}
	if (showhelps == 'open') {
		$('#descriptionDialog').show();
		$(this).hide();
	}
	if (showhelps == null) {
		$('#descriptionDialog').show();
		$(this).hide();
	}	
}





$(document).ready(function() { 

$("#kompasx").onTypeFinished(runkompas);
$("#kompasy").onTypeFinished(runkompas);

$("#nick").onTypeFinished(passcheck);
//$("#password").onTypeFinished(passcheckmd);





// nick and pass and button memory memory
	var ssss = readCookie("playername");
	if (ssss != '') {
	$("#nick").val(ssss);
	}

	var sss = readCookie("playerpass");
	if (sss != '') {
	$("#password").val(sss);
	}


	var bsss = readCookie("serverpassword");
	if (bsss != '') {
	$("#serverpassword").val(bsss);
	}



	var ss = readCookie("simplerenderbutton");
	if (ss == null) {
		$("#simplerenderbutton").attr("checked","checked");
		setSimpleMode(true);
	}

	if (ss == 'true') {
		$("#simplerenderbutton").attr("checked","checked");
		setSimpleMode(true);
	}

	if (ss == 'false') {
		$("#simplerenderbutton").removeAttr("checked");
		setSimpleMode(false);
	}


	var gridss = readCookie("hidegrid");
	if (gridss == null) {
		$("#hidegrid").removeAttr("checked");
		setHideGrid(false);
	}

	if (gridss == 'true') {
		$("#hidegrid").attr("checked","checked");
		setHideGrid(true);
	}

	if (gridss == 'false') {
		$("#hidegrid").removeAttr("checked");
		setHideGrid(false);
	}


	var skinss = readCookie("setskins");
	if (skinss == 'true') {
		$("#setskins").removeAttr("checked");
		setSkins(true);
	}

	if (skinss == 'false') {
		$("#setskins").attr("checked","checked");
		setSkins(false);
	}

	var setnamess = readCookie("setnames");
	if (setnamess == 'true') {
		$("#setnames").removeAttr("checked");
		setNames(true);
	}

	if (setnamess == 'false') {
		$("#setnames").attr("checked","checked");
		setNames(false);
	}

	var setdarks = readCookie("setdark");
	if (setdarks == 'true') {
		$("#setdark").attr("checked","checked");
		setDarkTheme(true);
	}

	if (setdarks == 'false') {
		$("#setdark").removeAttr("checked");
		setDarkTheme(false);
	}

	var setcolorss = readCookie("setcolors");
	if (setcolorss == 'true') {
		$("#setcolors").attr("checked","checked");
		setColorsOff(true);
	}

	if (setcolorss == 'false') {
		$("#setcolors").removeAttr("checked");
		setColorsOff(false);
	}

	var setmasss = readCookie("setmass");
	if (setmasss == 'true') {
		$("#setmass").attr("checked","checked");
		setShowMass(true);
	}

	if (setmasss == 'false') {
		$("#setmass").removeAttr("checked");
		setShowMass(false);
	}

	var largeborderss = readCookie("largeborders");
	if (largeborderss == 'true') {
		$("#largeborders").attr("checked","checked");
		setLargeBlobBorders(true);
	}

	if (largeborderss == 'false') {
		$("#largeborders").removeAttr("checked");
		setLargeBlobBorders(false);
	}

	var largenamess = readCookie("largenames");
	if (largenamess == 'true') {
		$("#largenames").attr("checked","checked");
		setLargeNames(true);
	}

	if (largenamess == 'false') {
		$("#largenames").removeAttr("checked");
		setLargeNames(false);
	}


	var setacids = readCookie("setacid");
	if (setacids == 'true') {
		$("#setacid").attr("checked","checked");
		setAcid(true);
	}

	if (setacids == 'false') {
		$("#setacid").removeAttr("checked");
		setAcid(false);
	}


	var setrealtimestatss = readCookie("setrealtimestats");
	if (setrealtimestatss == 'true') {
		$("#setrealtimestats").attr("checked","checked");
		OnChangeDisplayStats(true);
	}

	if (setrealtimestatss == 'false') {
		$("#setrealtimestats").removeAttr("checked");
		OnChangeDisplayStats(false);
	}





// nick memory end

passcheck();

//hoverka

$( "#playBtn" ).hover(
  function() {
if ($( "#region" ).val() == 'none')  {
    $( "#region" ).css("background-color","red").css("font-weight","bold").css("color","white");
	passcheck();
}
  }, function() {
if ($( "#region" ).val() == 'none') {
    $( "#region" ).css("background-color","white").css("font-weight","normal").css("color","#555");
	passcheck();
}
  }
);

// hoverka end


})

</script>



























<script>


var W=0;
var SPACE=0;
var Q=0;
var QRELEASE=0;
var WBOT=0;
var SPACEBOT=0;
var SPECTATE=0;
var serverFPS=0;
var _serverFPS=0;
var CHAT=0;
var NAME=0;
var loadUp=0;
var _loadUp=0;
var loadDown=0;
var _loadDown=0;
var latency=true;
﻿var mmu = 0;
var myframe = 0;
var animatedTimers = {};
var curframe = {};
var maxframe = {};
maxframe['mangoo'] = 18;
maxframe['pac-man'] = 10;
maxframe['noel'] = 10;
maxframe['nеzna'] = 14;


var playerGroup = [];
var isTargeting = false;
var socketState = 0;
var socketaddr = '';
var targetBufferX = 0;
var targetBufferY = 0;
var mapmaxX = 0;
var mapmaxY = 0;
var freeze = false;
var settednick = '';
var chathistory = 100;
var spectclick = false;
var helpte = $("#chat_textbox").attr("placeholder");




(function(win, $) {
var myx = 0;
var myy = 0;
var myla = '';
var dop = 0;
var mycolo = '';
var myprevnick = '';
    const DEBUG = false;
    /**
     * @param {string} total
     * @return {undefined}
     */
    function debug(total) {
        if (DEBUG) {
            console.log("debug: " + Date.now() + " " + total);
        }
    }
    /**
     * @return {undefined}
     */
    function init() {
        /** @type {boolean} */
        initialized = true;
        var isTyping = false;
        var chattxt;
        /** @type {(HTMLElement|null)} */
        canvas = cv = document.getElementById("canvas");
        chatarea = document.getElementById("chatlog");
        ctx = canvas.getContext("2d");
        /**
         * @param {Event} e
         * @return {undefined}
         */




        canvas.onfocus = function () {
            isTyping = false;
        };

        document.getElementById("chat_textbox").onblur = function () {
            isTyping = false;
	    $("#chat_textbox").attr("placeholder",helpte);
        };


        document.getElementById("chat_textbox").onfocus = function () {
	    $("#chat_textbox").attr("placeholder","");
            isTyping = true;
        };

        document.getElementById("nick").onblur = function () {
            isTyping = false;
        };


        document.getElementById("nick").onfocus = function () {
            isTyping = true;
        };

        document.getElementById("password").onblur = function () {
            isTyping = false;
        };


        document.getElementById("password").onfocus = function () {
            isTyping = true;
        };


        document.getElementById("serverpassword").onblur = function () {
            isTyping = false;
        };


        document.getElementById("serverpassword").onfocus = function () {
            isTyping = true;
        };

        document.getElementById("kompasx").onblur = function () {
            isTyping = false;
        };


        document.getElementById("kompasx").onfocus = function () {
            isTyping = true;
        };

        document.getElementById("kompasy").onblur = function () {
            isTyping = false;
        };


        document.getElementById("kompasy").onfocus = function () {
            isTyping = true;
        };


        canvas.onmousedown = function(e) {
            if (isMobile) {
                /** @type {number} */
                var x0 = e.clientX - (5 + width / 5 / 2);
                /** @type {number} */
                var y0 = e.clientY - (5 + width / 5 / 2);
                if (Math.sqrt(x0 * x0 + y0 * y0) <= width / 5 / 2) {
                    updateMousePosition();
                    sendPacket(17);
                    return;
                }
            }
	 if (!isSpectating) {
            mouseX = e.clientX;
            mouseY = e.clientY;
            updateMouseAim();
            updateMousePosition();
	 }
	 if (isSpectating) {
            mouseX = e.clientX;
            mouseY = e.clientY;
	    spectclick = true;
            updateMouseAim();
            updateMousePosition();
	    middleX = aimX;
	    middleY = aimY;
		if (middleX > maxX-1000) { middleX = maxX-1000;}
		if (middleX < 1000) { middleX = 1000;}
		if (middleY > maxY-1000) { middleY = maxY-1000;}
		if (middleY < 1000) { middleY = 1000;}
	 }



        };


	chatarea.onmousedown = function(e) {
	 if (isSpectating) {
            mouseX = e.clientX;
            mouseY = e.clientY;
	    spectclick = true;
            updateMouseAim();
            updateMousePosition();
	    middleX = aimX;
	    middleY = aimY;
		if (middleX > maxX-1000) { middleX = maxX-1000;}
		if (middleX < 1000) { middleX = 1000;}
		if (middleY > maxY-1000) { middleY = maxY-1000;}
		if (middleY < 1000) { middleY = 1000;}
	 }
	}


        window.onmousemove = function(e) {
	 if (!isSpectating) {
            mouseX = e.clientX;
            mouseY = e.clientY;
            updateMouseAim();
	 }
        };





        /**
         * @return {undefined}
         */
        canvas.onmouseup = function() {};
        if (/firefox/i.test(navigator.userAgent)) {
            document.addEventListener("DOMMouseScroll", onDocumentMouseScroll, false);
        } else {
            /** @type {function (Event): undefined} */
            document.body.onmousewheel = onDocumentMouseScroll;
        }
        /** @type {boolean} */
        var keySpacePressed = false;
        /** @type {boolean} */
        var keyQPressed = false;
        /** @type {boolean} */
        var keyWPressed = false;
        var keyEPressed = false;
		var keyRPressed = false;
        /**
         * @param {?} e
         * @return {undefined}
         */
        win.onkeydown = function(e) {
            if (!(32 != e.keyCode)) {
                if ((!keySpacePressed) && (!isTyping)) {
                    SPACE = 1; // Space key has been pressed
                    /** @type {boolean} */
                    keySpacePressed = true;
                }
            }
            if (!(81 != e.keyCode)) {
                if ((!keyQPressed) && (!isTyping)) {
                    Q = 2; // Q key has been pressed
                    /** @type {boolean} */
                    keyQPressed = true;
                }
            }
            if (!(87 != e.keyCode)) {
                if ((!keyWPressed) && (!isTyping) && (!freeze)) {
                    W = 8; // W key has been pressed
                    /** @type {boolean} */ 
                    keyWPressed = true;
                }
            }
			
			if (!(82 != e.keyCode)) {
                if ((!keyRPressed) && (!isTyping) && (!freeze)) {
                    WBOT = 16; // R key has been pressed
                    /** @type {boolean} */ 
                    keyRPressed = true;
                }
            }

			if (!(69 != e.keyCode)) {
                if ((!keyEPressed) && (!isTyping) && (!freeze)) {
                    SPACEBOT = 32; // E key has been pressed
                    /** @type {boolean} */ 
                    keyEPressed = true;
                }
            }

            /*if (!(86 != e.keyCode)) {
                if ((!keyVPressed) && (!isTyping) && (!freeze)) {
                    V = 64 // V key has been pressed
                    keyVPressed = true;
                }
            }*/



            if (27 == e.keyCode) { //XXX
                if ($("#overlays").css("display") == "none") {
                    showOverlays(true);
                } else {
                    hide();
                }
            }

            if (69 == e.keyCode) { //XXX
		if (!isTyping) {
                if (isTargeting == true) {
                    shootonn();
                } else {
                    shootofff();
                }
		}
            }

            if (38 == e.keyCode) { //XXX
		if (!isTyping && isSpectating) {
	    spectclick = true;
                 aimY = middleY - 1000;
		 middleY -= 1000;
		if (middleY < 1000) { middleY = 1000;}
		updateMousePosition();
		}
            }
            if (40 == e.keyCode) { //XXX
		if (!isTyping && isSpectating) {
	    spectclick = true;
                 aimY = middleY + 1000;
		 middleY += 1000;
		if (middleY > maxY-1000) { middleY = maxY-1000;}
		updateMousePosition();
		}
            }

            if (37 == e.keyCode) { //XXX
		if (!isTyping && isSpectating) {
	    spectclick = true;
                 aimX = middleX - 1000;
		 middleX -= 1000;
		if (middleX < 1000) { middleX = 1000;}
		updateMousePosition();
		}
            }

            if (39 == e.keyCode) { //XXX
		if (!isTyping && isSpectating) {
	    spectclick = true;
                 aimX = middleX + 1000;
		 middleX += 1000;
		if (middleX > maxX-1000) { middleX = maxX-1000;}
		updateMousePosition();
		}
            }

            if (70 == e.keyCode) { //XXX
		if (!isTyping) {
                	if (freeze == true) {
                	    freeze = false;
			    $("#pauseblock").hide();
				fly("Game resumed");
                	} else {
                	    freeze = true;
			    $("#pauseblock").show();
				fly("Game paused");
                	}
		}
            }

            if (65 == e.keyCode) { 
		if (!isTyping) {

                if ($("#overlays").css("display") == "none") {
                    showOverlays(true);
			jQuery('#opts, #langs, #settingsDialog').show();
                } else {
                    hide();
                }

		}
            }


            if (13 == e.keyCode) { //XXX
                    if (isTyping) {
                        isTyping = false;
                        document.getElementById("chat_textbox").blur();
			var chatlang = readCookie("lang");
			if (chatlang == null) { chatlang = 'en' };
                        chattxt = document.getElementById("chat_textbox").value;
                        if (chattxt.length > 0) sendChat(chattxt + " :" + chatlang);
                        document.getElementById("chat_textbox").value = "";

                    }
                    else {
                        if (!hasOverlay) {
                            document.getElementById("chat_textbox").focus();
                            isTyping = true;
                        }
                    }
		}



        };
        /**
         * @param {?} event
         * @return {undefined}
         */
        win.onkeyup = function(event) {
            if (32 == event.keyCode) {
                /** @type {boolean} */
                keySpacePressed = false;
            }
            if (87 == event.keyCode) {
                /** @type {boolean} */
                keyWPressed = false;
            }
			if (82 == event.keyCode) {
                /** @type {boolean} */
                keyRPressed = false;
            }
			if (69 == event.keyCode) {
                /** @type {boolean} */
                keyEPressed = false;
            }
            /*if (86 == event.keyCode) {
                keyVPressed = false;
            }*/
			if (81 == event.keyCode) {
                if (keyQPressed) {
                    QRELEASE = 4; // Q key has been released
                    /** @type {boolean} */
                    keyQPressed = false;
                }
            }
        };
        /**
         * @return {undefined}
         */
        win.onblur = function() {
            sendPacket(19);
            /** @type {boolean} */
            keyWPressed = keyQPressed = keySpacePressed = false;
        };
        /** @type {function (): undefined} */
        window.onresize = onResize;
        onResize();
        if (win.requestAnimationFrame) {
            win.requestAnimationFrame(tick);
        } else {
            setInterval(draw, 1E3 / 60);
        }
        setInterval(updateMousePosition, 40);
		setInterval(updateDebug, 1000);


        $("#overlays").show();

    }
    /**
     * @param {Event} event
     * @return {undefined}
     */
    function onDocumentMouseScroll(event) {

        zoom *= Math.pow(0.9, event.wheelDelta / -120 || (event.detail || 0));
        if (!isSpectating) { 
            if (0.8 > zoom && isUnlimitedZoom) {
                zoom = 0.8;
            }
            if (zoom > 4 / ratio) {
                zoom = 4 / ratio;
            }
       }

        if (isSpectating) { 
            if (0.2 > zoom && isUnlimitedZoom) {
                zoom = 0.2;
            }
            if (zoom > 3 / ratio) {
                zoom = 3 / ratio;
            }
       }


    }
    /**
     * @return {undefined}
     */
    function update() {
        if (0.4 > ratio) {
            /** @type {null} */
            context = null;
        } else {
            /** @type {number} */
            var minX = Number.POSITIVE_INFINITY;
            /** @type {number} */
            var minY = Number.POSITIVE_INFINITY;
            /** @type {number} */
            var maxX = Number.NEGATIVE_INFINITY;
            /** @type {number} */
            var maxY = Number.NEGATIVE_INFINITY;
            /** @type {number} */
            var maxSize = 0;
            /** @type {number} */
            var i = 0;
            for (; i < list.length; i++) {
                var data = list[i];
                if (!!data.shouldRender()) {
                    if (!data.wasSimpleDrawing) {
                        if (!(20 >= data.size * ratio)) {
                            /** @type {number} */
                            maxSize = Math.max(data.size, maxSize);
                            /** @type {number} */
                            minX = Math.min(data.x, minX);
                            /** @type {number} */
                            minY = Math.min(data.y, minY);
                            /** @type {number} */
                            maxX = Math.max(data.x, maxX);
                            /** @type {number} */
                            maxY = Math.max(data.y, maxY);
                        }
                    }
                }
            }
            context = path.init({
                minX: minX - (maxSize + 100),
                minY: minY - (maxSize + 100),
                maxX: maxX + (maxSize + 100),
                maxY: maxY + (maxSize + 100),
                maxChildren: 2,
                maxDepth: 4
            });
            /** @type {number} */
            i = 0;
            for (; i < list.length; i++) {
                if (data = list[i], data.shouldRender() && !(20 >= data.size * ratio)) {
                    /** @type {number} */
                    var j = 0;
                    /** @type {number} */
                    var x = 0;
                    /** @type {number} */
                    var y = 0;
                    for (; j < data.points.length; ++j) {
                        x = data.points[j].x;
                        y = data.points[j].y;
                        if (!(x < offsetX - width / 2 / ratio)) {
                            if (!(y < offsetY - height / 2 / ratio)) {
                                if (!(x > offsetX + width / 2 / ratio)) {
                                    if (!(y > offsetY + height / 2 / ratio)) {
                                        context.insert(data.points[j]);
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    /**
     * @return {undefined}
     */
    function updateMouseAim() {



        aimX = (mouseX - width / 2) / ratio + offsetX;
        aimY = (mouseY - height / 2) / ratio + offsetY;
    }
	
	function updateDebug() {
	serverFPS=_serverFPS;
	_serverFPS=0;
	loadUp=~~(_loadUp/100)/10;
	loadDown=~~(_loadDown/100)/10;
	_loadUp=0;
	_loadDown=0;
	}

    /**
     * @return {undefined}
     */
    function hide() {

        if ($("#stats").css("display") != "none") {
		$('#stats,#serverstats').hide();
		$('#statssmall').show();
		$('#descriptionDialog').show();
		$('#helloDialog').show();
		realtimeenable();
        }
	else {
	        hasOverlay = false;
        	$("#overlays").hide();
		realtimedisable();
	}
    }
    /**
     * @param {boolean} isAlive
     * @return {undefined}
     */
    function showOverlays(isAlive) {
	realtimeenable();
        hasOverlay = true;
        /** @type {null} */
        nick = null;
        $("#overlays").fadeIn(isAlive ? 200 : 200);
        OnShowOverlay(isAlive);
        if (!isAlive) {
        }
    }



    /**
     * @return {undefined}
     */
    function connect() {
        if (initialized) {
            if (region) {
                $("#connecting").show();
            }
        }
    }
    /**
     * @param {string} url
     * @return {undefined}
     */
    function open(url) {
socketaddr = url;
        if (socket) {
            /** @type {null} */
            socket.onopen = null;
            /** @type {null} */
            socket.onmessage = null;
            /** @type {null} */
            socket.onclose = null;
            try {
                socket.close();
            } catch (b) {}
            /** @type {null} */
            socket = null;
        }
 

        /** @type {Array} */
        ids = [];
        /** @type {Array} */
        playerGroup = [];
        blobs = {};
        /** @type {Array} */
        list = [];
        /** @type {Array} */
        sprites = [];
        /** @type {Array} */
        users = [];
        /** @type {null} */
        img = angles = null;
        /** @type {number} */
        score = 0;
        $("#server_ip").val(url.substr(5)); //XXX
        console.log("Connecting to PetriDish.pw server at " + url);
        /** @type {WebSocket} */
        socket = new WebSocket(url);
        /** @type {string} */
        socket.binaryType = "arraybuffer";
        /** @type {function (): undefined} */
        socket.onopen = socketOpen;
        /** @type {function (MessageEvent): undefined} */
        socket.onmessage = socketMessage;
        /** @type {function (): undefined} */
        socket.onclose = socketClose;
        /**
         * @return {undefined}
         */
        socket.onerror = function() {
            console.log("PetriDish.pw report: socket error");
        };
    }
    /**
     * @param {number} bytes
     * @return {?}
     */
    function createBuffer(bytes) {
        return new DataView(new ArrayBuffer(bytes));
    }
    /**
     * @param {?} array
     * @return {undefined}
     */
    function socketWrite(array) {
	_loadUp+=56+array.byteLength;
        socket.send(array.buffer);
    }
    /**
     * @return {undefined}
     */
    function socketOpen() {
		isAdmin = false;
		_socket = {};
		$(adminbtn).hide();
		$(adminka).hide();
		if(typeof(admindata)){
			delete(admindata);
		}
        /** @type {number} */
        backoff = 500;
	    socketState = 1;
        $("#connecting").hide();
		jQuery("#playBtn").removeAttr("disabled").removeAttr("alt").removeAttr("title");
		jQuery("#overlays").css("background","");
		jQuery("#overlays").css("background-color","rgba(0, 0, 0, 0.5)");

		jQuery("#playBtn").css("float","left").css("width","255px");
		jQuery("#spectateBtn").show();

        console.log("PetriDish.pw report: socket open");
        //var buffer = createBuffer(5);
        //buffer.setUint8(0, 254);
        //buffer.setUint32(1, 4, true);
        //socketWrite(buffer);
		isFirstBorder=false;
		var pass = serverpassword.value;
		sendPass();
        buffer = createBuffer(5);
        buffer.setUint8(0, 255);
        buffer.setUint32(1, 673720361, true);
        socketWrite(buffer);
        sendNick();
	sendChat("***playerenter***");
	sendChat("***playerenter***");
    }
    /**
     * @return {undefined}
     */
    function socketClose() {
	socketState = 0;
	socketaddr = '';
        console.log("PetriDish.pw report: socket close");
        setTimeout(connect, backoff);
        backoff *= 1.5;
    }
    /**
     * @param {MessageEvent} a
     * @return {undefined}
     */
    function socketMessage(a) {
			parse(new DataView(a.data));
    }
    /**
     * @param {DataView} reader
     * @return {undefined}
     */
    function parse(reader) {
        /**
         * @return {?}
         */
        function encode() {
            /** @type {string} */
            var str = "";
            for (;;) {
                var b = reader.getUint16(offset, true);
                offset += 2;
                if (0 == b) {
                    break;
                }
                str += String.fromCharCode(b);
            }
            return str;
        }
        /** @type {number} */
        var offset = 0;
		_loadDown+=56+reader.byteLength;
		_serverFPS++;
		try{
		/** @type {number} */
        timestampLastDraw = +new Date;
        /** @type {number} */
        var rand = Math.random();
        /** @type {boolean} */
        qweA = false;
		var packets=reader.getUint8(offset++);
		if(packets & 1){
		playerGroup = [];

                ids = [];
				
				blobs = {};
				
				list = [];
		}
		if(packets&2){
        /** @type {number} */
        i = 0;
        for (;;) {
            var id = reader.getUint32(offset, true);
            offset += 4;
            if (0 == id) {
                break;
            }
            ++i;
            var x = reader.getInt16(offset, true);
            offset += 2;
            var y = reader.getInt16(offset, true);
            offset += 2;
            var size = reader.getUint16(offset, true);
            offset += 2;
			var color = 0,
			nameLength = reader.getUint8(offset++);
			if (nameLength > 0){
            var flags=reader.getUint16(offset,true),
			colorID=flags%2048;
			if(!!(flags&2048))ids.push(id);
			offset+=2;
			color=decodeColor(colorID);
			}
			var readChar,
			name = "";
			nameLength--;
            for (var i=0;i<nameLength;i++) {
                readChar = reader.getUint16(offset, true);
                offset += 2;
                name += String.fromCharCode(readChar);
            }
            /** @type {null} */
            var blob = null;
            if (blobs.hasOwnProperty(id)) {
                blob = blobs[id];
                blob.updatePos();
                blob.ox = blob.x;
                blob.oy = blob.y;
                blob.oSize = blob.size;
                if(color != 0)blob.color = color;
		if (playerGroup[0]) {
			if (blob.id == playerGroup[0].id) {
				//if (window.selmode == "ARENA") { blob.color = "#eb4b00"; }
				//if (window.selmode == "FATBOY-ARENA") { blob.color = "#eb4b00"; }
			}


			for (var i = 0, leng = playerGroup.length; i < leng; i++) {
    				if (i in playerGroup) {
      					if (blob.id == playerGroup[i].id) {
						if (window.selmode == "ARENA") { blob.color = "#eb4b00"; }
						if (window.selmode == "FATBOY-ARENA") { blob.color = "#eb4b00"; }
					}
    				}
			}

		}
		if (playerGroup[0]) {
			myx = ~~(playerGroup[0].x);
			myy = ~~(playerGroup[0].y);
			mycolo = playerGroup[0].color;
		}

            } else {
			if(color == 0)color = "#00FF00";
                blob = new Blob(id, x, y, size, color, name);
                list.push(blob);
                blobs[id] = blob;
                blob.pX = x;
                blob.pY = y;
				blob.isVirus = colorID>1791?true:false;
				blob.colorID=colorID;
            }
            blob.isAgitated = false;
            blob.nx = x;
            blob.ny = y;
            blob.nSize = size;
            /** @type {number} */
            blob.updateCode = rand;
            /** @type {number} */
            blob.updateTime = timestampLastDraw;
            blob.flags = flags;
            if (name) {
                blob.setName(name);

	//	if (playerGroup[0]) {
		//	if (blob.id == playerGroup[0].id) {
		//		var numa = document.getElementById('nick').value;
		//		if (window.selmode == "ARENA") { blob.setName(numa); }
		//		if (window.selmode == "FATBOY-ARENA") { blob.setName(numa); }
		//	}

		//	for (var i = 0, leng = playerGroup.length; i < leng; i++) {
    			//	if (i in playerGroup) {
      			//		if (blob.id == playerGroup[i].id) {
				//		if (window.selmode == "ARENA") { blob.setName(numa); }
				//		if (window.selmode == "FATBOY-ARENA") { blob.setName(numa); }
				//	}
    			//	}
		//	}


	//	}

            }
	    var uuy = window.selmode;
            if ((blob.size == 708) && !(name) && (uuy == "BLACKHOLE") && (blob.id < 5000)) {blob.setName("Black Hole");}

	    if (blob.isVirus) { blob.setName("Virus"); }

            if (-1 != ids.indexOf(id)) {
                if (-1 == playerGroup.indexOf(blob)) {
                    /** @type {string} */
                    document.getElementById("overlays").style.display = "none";

                    playerGroup.push(blob);
                    if (1 == playerGroup.length) {
                        offsetX = blob.x;
                        offsetY = blob.y;
			//ResetChart();
			OnGameStart(playerGroup);
			settednick = playerGroup[0].name;
			//console.log(playerGroup[0].color);
			//if (uuy == "ARENA") { playerGroup[0].color = "#eb4b00";  }
			//if (uuy == "FATBOY-ARENA") { playerGroup[0].color = "#eb4b00";  }
			//console.log(playerGroup[0].color);

                    }
                }
            }
        }
		}
		if(packets & 4){
        var qweS = reader.getUint16(offset, true);
        offset += 2;
        /** @type {number} */
        var i = 0;
        for (; i < qweS; ++i) {
            var blob1 = blobs[reader.getUint32(offset, true)];
            var blob2 = blobs[reader.getUint32(offset + 4, true)];
            offset += 8;
                if (blob2) {
				if (blob1) {
			OnCellEaten(blob1, blob2);
			}
                    blob2.destroy();
					if(blob1){
                    blob2.ox = blob2.x;
                    blob2.oy = blob2.y;
                    blob2.oSize = blob2.size;
                    blob2.nx = blob1.x;
                    blob2.ny = blob1.y;
                    blob2.nSize = blob2.size;
                    /** @type {number} */
                    blob2.updateTime = timestampLastDraw;
					}
                }
}

	if (blob1) {
		if (playerGroup[0]) {
			myx = ~~(playerGroup[0].x);
			myy = ~~(playerGroup[0].y);
		}
	}


        }
		if(packets&8){
        var qweT = reader.getUint32(offset, true);
        offset += 4;
        /** @type {number} */
        i = 0;
        for (; i < qweT; i++) {
            id = reader.getUint32(offset, true);
            offset += 4;
            blob = blobs[id];
            if (null != blob) {
                blob.destroy();
            }
        }
		}
        if (qweA) {
            if (0 == playerGroup.length) {
                showOverlays(false);
            }
        }
    if(packets&16){
	var b=reader.getUint8(offset++);
	            if(b!=255){
                angles=null;
                users = [];
                var a = 0;
                for (; a < b; ++a) {
                    var token = reader.getUint8(offset++, true);
					var str="";
					for (;;) {
                var c = reader.getUint16(offset, true);
                offset += 2;
                if (0 == c) {
                    break;
                }
                str += String.fromCharCode(c);
            }
                    users.push({
                        id: token,
                        name: str
                    });
                }
                render();
}else{
                angles = [];
                a = 0;
                for (; a < 3; ++a) {
                    angles.push(reader.getFloat32(offset, true));
                    offset += 4;
                }
                render();
				}
	}
	if(packets&32){
	            minX = reader.getInt32(offset, true);
                offset += 4;
                minY = reader.getInt32(offset, true);
                offset += 4;
                maxX = reader.getInt32(offset, true);
                offset += 4;
                maxY = reader.getInt32(offset, true);
                offset += 4;
				

mapmaxX = maxX;
mapmaxY = maxY;

                middleX = (maxX + minX) / 2;
                middleY = (maxY + minY) / 2;
	}
	if(packets&64){
	            middleX = reader.getInt32(offset, true);
                offset += 4;
                middleY = reader.getInt32(offset, true);
                offset += 4;
                chunk = reader.getFloat32(offset, true);
                offset += 4;
	}
	if(packets&128){
	var length=reader.getUint16(offset,true);
	offset+=2;
	for(var k=0;k<length;k++){
	var color=reader.getUint16(offset,true);
	offset+=2;
	var nlen=reader.getUint8(offset++);
	var name="";
	if(nlen===0){
	name="An unnamed cell";
	}else{
	for(var i=0;i<nlen;i++){
                name += String.fromCharCode(reader.getUint16(offset, true));
				offset+=2;
	}
	}
	var mlen=reader.getUint8(offset++);
	var message="";
	for(var i=0;i<mlen;i++){
                message += String.fromCharCode(reader.getUint16(offset, true));
				offset+=2;
	}
        chatBoard.push({
            "name": name,
            "color": decodeColor(color),
            "message": message,
            "time": Date.now()
        });
        drawChatBoard();
	}
	}
	} catch(e){};
    }








    function addChat(view, offset) {
        function getString() {
            var text = '',
                char;
            while ((char = view.getUint16(offset, true)) != 0) {
                offset += 2;
                text += String.fromCharCode(char);
            }
            offset += 2;
            return text;

        }

        var flags = view.getUint8(offset++);
        // for future expansions
        if (flags & 2) {
            offset += 4;
        }
        if (flags & 4) {
            offset += 8;
        }
        if (flags & 8) {
            offset += 16;
        }

        var r = view.getUint8(offset++),
            g = view.getUint8(offset++),
            b = view.getUint8(offset++),
            color = (r << 16 | g << 8 | b).toString(16);
        while (color.length > 6) {
            color = '0' + color;
        }
        color = '#' + color;
        chatBoard.push({
            "name": getString(),
            "color": color,
            "message": getString(),
            "time": Date.now()
        });
        drawChatBoard();
    }

    function drawChatBoard() {
        var nowtime = Date.now();
        var lasttime = 0;
        if (chatBoard.length >= 1)
            lasttime = chatBoard[chatBoard.length - 1].time;
        else return;
        var deltat = nowtime - lasttime;


        var len = chatBoard.length;

	if(isDarkTheme) { $("#chatlog").css("color","white"); $("#chat_textbox").css("color","white").css("background","rgba(255, 255, 255, 0.2) none repeat scroll 0 0"); }
	if(!isDarkTheme) { $("#chatlog").css("color","black"); $("#chat_textbox").css("color","black").css("background","rgba(0, 0, 0, 0.2) none repeat scroll 0 0");}

var chatnick = chatBoard[len - 1].name;
var stringlang;
stringlang = '';
var iddlina = chatnick.indexOf(")") - 1;
var chatid = chatnick.substr(1,iddlina);
var chatnicknoid = chatnick.substr(iddlina+2,30);
var state;
var mod;
var verif = '';
mod = '';
var escnick = htmlspecialchars(chatnicknoid);

if ((supernames.indexOf(escnick.toLowerCase()) != -1) && (escnick.toLowerCase() != 'wrong password')) { verif = '<span class="verified"></span>'; }

var gamelang = readCookie("lang");
if (gamelang == null) { gamelang = 'en'; }

	var chatenter = readCookie("chatenter");
	if (chatenter == null) {
		state = ' style="display:none;" ';
	}
	if (chatenter == 'true') {
		state = '';
	}

	if (chatenter == 'false') {
		state = ' style="display:none;" ';
	}




var chattt = htmlspecialchars(chatBoard[len - 1].message);




if (chatBoard[len - 1].message == '***playerenter***') {
dop = dop+20;
		if (gamelang == 'ru') { chattt = ' вошёл в игру. '; }
		if (gamelang == 'fr') { chattt = ' entre dans le chat. '; }
		if (gamelang == 'en') { chattt = ' enters the game. '; }

        var mg = "<div " + state + " class='chatenter'>" + verif + "<small><strong title='" + chatid + "' style='color:" + chatBoard[len - 1].color + "'>" + escnick + ":</strong> " + chattt + "</small></div>";

}

if (chatBoard[len - 1].message != '***playerenter***') {

chattt = makeItCultural(chattt);

dop = 0;
stringlang = chattt.substr(-3,3);
state = '';
	var checkchat = readCookie("ruschat");
	if ((checkchat == 'false') && (stringlang.substr(1,2) == 'ru') ) {
		state = ' style="display:none;" ';
	}
	var checkchat1 = readCookie("engchat");
	if ((checkchat1 == 'false') && (stringlang.substr(1,2) == 'en') ) {
		state = ' style="display:none;" ';
	}
	var checkchat2 = readCookie("frchat");
	if ((checkchat2 == 'false') && (stringlang.substr(1,2) == 'fr') ) {
		state = ' style="display:none;" ';
	}


	if (supermods.indexOf(chatnicknoid.toLowerCase()) != -1) {
		mod = "style='color:white;background-color:red;padding:0px 5px;'";
	}

	if (superhelpers.indexOf(chatnicknoid.toLowerCase()) != -1) {
		mod = "style='color:white;background-color:green;padding:0px 5px;'";
	}



	var selectedRegion = socketaddr.substr(5,socketaddr.length);


	if ((selectedRegion == '151.80.47.72:908') && (chatnicknoid.toLowerCase().substr(0,5) == '[red]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:909') && (chatnicknoid.toLowerCase().substr(0,4) == '[ho]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:910') && (chatnicknoid.toLowerCase().substr(0,6) == '[ussr]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:911') && (chatnicknoid.toLowerCase().substr(0,5) == '[sml]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 


	if ((selectedRegion == '151.80.47.72:912') && (chatnicknoid.toLowerCase().substr(0,4) == '[fn]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:915') && (chatnicknoid.toLowerCase() == 'qarantin' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:916') && (chatnicknoid.toLowerCase().substr(0,5) == '[cbi]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:917') && (chatnicknoid.toLowerCase().substr(0,5) == '[knb]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:918') && (chatnicknoid.toLowerCase().substr(0,5) == '[ket]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:919') && (chatnicknoid.toLowerCase().substr(0,5) == '[w.w]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:920') && (chatnicknoid.toLowerCase().substr(0,4) == '[ms]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:921') && (chatnicknoid.toLowerCase().substr(0,6) == '[russ]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:922') && (chatnicknoid.toLowerCase().substr(0,4) == '[hc]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:923') && (chatnicknoid.toLowerCase().substr(0,5) == '[rrq]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:924') && (chatnicknoid.toLowerCase().substr(0,4) == '[gs]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:925') && (chatnicknoid.toLowerCase().substr(0,6) == '[drag]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:926') && (chatnicknoid.toLowerCase().substr(0,4) == '[ds]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:927') && (chatnicknoid.toLowerCase().substr(0,4) == '[wf]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:928') && (chatnicknoid.toLowerCase().substr(0,4) == '[vg]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 


	if ((selectedRegion == '151.80.47.72:929') && (chatnicknoid.toLowerCase().substr(0,7) == '[18-25]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:930') && (chatnicknoid.toLowerCase().substr(0,5) == '[inv]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:931') && (chatnicknoid.toLowerCase().substr(0,5) == '[cod]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:933') && (chatnicknoid.toLowerCase().substr(0,5) == '[ttk]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	} 

	if ((selectedRegion == '151.80.47.72:934') && (chatnicknoid.toLowerCase().substr(0,4) == '[sb]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:935') && (chatnicknoid.toLowerCase().substr(0,5) == '[fff]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:936') && (chatnicknoid.toLowerCase().substr(0,7) == '[limon]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:937') && (chatnicknoid.toLowerCase().substr(0,6) == '[cati]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:938') && (chatnicknoid.toLowerCase().substr(0,4) == '[bw]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:939') && (chatnicknoid.toLowerCase().substr(0,5) == '[vbr]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:940') && (chatnicknoid.toLowerCase().substr(0,6) == '[skyp]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:941') && (chatnicknoid.toLowerCase().substr(0,8) == '[мажоры]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:942') && (chatnicknoid.toLowerCase().substr(0,4) == '[mr]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:943') && (chatnicknoid.toLowerCase().substr(0,7) == '[demon]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:944') && (chatnicknoid.toLowerCase().substr(0,5) == '[fal]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:945') && (chatnicknoid.toLowerCase().substr(0,5) == '[vol]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:946') && (chatnicknoid.toLowerCase().substr(0,6) == '[meow]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:947') && (chatnicknoid.toLowerCase().substr(0,6) == '[foxz]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:948') && (chatnicknoid.toLowerCase().substr(0,5) == '[hbb]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:949') && (chatnicknoid.toLowerCase().substr(0,5) == '[fin]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:950') && (chatnicknoid.toLowerCase().substr(0,5) == '|fbi|' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:951') && (chatnicknoid.toLowerCase().substr(0,5) == '[btw]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:952') && (chatnicknoid.toLowerCase().substr(0,6) == '[aces]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:954') && (chatnicknoid.toLowerCase().substr(0,6) == '[kill]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:955') && (chatnicknoid.toLowerCase().substr(0,5) == '[sfh]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:956') && (chatnicknoid.toLowerCase().substr(0,6) == '{bear}' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:957') && (chatnicknoid.toLowerCase().substr(0,4) == '[xs]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:958') && (chatnicknoid.toLowerCase().substr(0,5) == '[•••]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:959') && (chatnicknoid.toLowerCase().substr(0,6) == '[cool]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:960') && (chatnicknoid.toLowerCase().substr(0,5) == '|dsm|' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:961') && (chatnicknoid.toLowerCase().substr(0,5) == '[тут]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}


	if ((selectedRegion == '151.80.47.72:962') && (chatnicknoid.toLowerCase().substr(0,6) == '[bild]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}


	if ((selectedRegion == '151.80.47.72:963') && (chatnicknoid.toLowerCase().substr(0,4) == '|ms|' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:964') && (chatnicknoid.toLowerCase().substr(0,8) == '[wolves]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:965') && (chatnicknoid.toLowerCase().substr(0,5) == '[lsp]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:966') && (chatnicknoid.toLowerCase().substr(0,5) == '[skb]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:967') && (chatnicknoid.toLowerCase().substr(0,4) == '[fl]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:968') && (chatnicknoid.toLowerCase().substr(0,5) == '[zzz]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:969') && (chatnicknoid.toLowerCase().substr(0,4) == '[se]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:970') && (chatnicknoid.toLowerCase().substr(0,4) == '[72]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:971') && (chatnicknoid.toLowerCase().substr(0,4) == '[nd]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

	if ((selectedRegion == '151.80.47.72:972') && (chatnicknoid.toLowerCase().substr(0,6) == '[zum+]' )) {
	mod = "style='color:black;background-color:orange;padding:0px 5px;'";
	}

        var mg = "<div " + state + " class='" + stringlang.substr(1,2) +  "' " + mod + ">" + verif + "<strong onclick='doo(" + chatid + ");' title='" + chatid + "' style='color:" + chatBoard[len - 1].color + "'>" + escnick + ":</strong> " + chattt.substr(0,chattt.length-4) + "</div>";

}







	





	$("#chatlog").append(mg);
	if (jQuery('#chatlog div').length > chathistory) { jQuery('#chatlog div').eq(0).remove(); }


var chatWindow = document.getElementById("chatlog");
dif = chatWindow.scrollHeight - chatWindow.scrollTop - dop;

var scrollchats = readCookie("scrollchat");



if (scrollchats == null) { dif = 0; }
if (scrollchats == false) { dif = 0; }


if (dif < 530) {
	$("#chatlog").scrollTop(500000);
}



        var from = len - 15;
        if (from < 0) from = 0;


    }
















    /**
     * @param {DataView} reader
     * @param {number} offset
     * @return {undefined}
     */
    /**
     * @return {undefined}
     */
	function decodeColor(colorID){
	var r=0;
	var g=0;
	var b=0;
	var color=0;
	if(colorID<256){
			r=255;
			g=7+(colorID%256)*0.972549019607843137;
			b=7;
			}else if(colorID<512){
			r=255-(colorID%256)*0.972549019607843137;
			g=255;
			b=7;
			}else if(colorID<768){
			r=7;
			g=255;
			b=7+(colorID%256)*0.972549019607843137;
			}else if(colorID<1024){
			r=7;
			g=255-(colorID%256)*0.972549019607843137;
			b=255;
			}else if(colorID<1280){
			r=7+(colorID%256)*0.972549019607843137;
			g=7;
			b=255;
			}else if(colorID<1536){
			r=255;
			g=7;
			b=255-(colorID%256)*0.972549019607843137;
			}else if(colorID<1792){
			r=colorID-1536;
			g=colorID-1536;
			b=colorID-1536;
			}else if(colorID==1792){
			r=51;
			g=255;
			b=51;
			}else if(colorID==1793){
			r=206;
			g=99;
			b=99;
			}
			color = (r << 16 | g << 8 | b << 0).toString(16);
            for (; 6 > color.length;) {

                color = "0" + color;
            }

            color = "#" + color;
			return color;
	}
    function updateMousePosition() {
     if ((!isSpectating) || (isSpectating && (spectclick == true))) {
        if (isSocketOpen()) {
            /** @type {number} */
            var normalizeX = mouseX - width / 2;
            /** @type {number} */
            var normalizeY = mouseY - height / 2;
			if(normalizeX*normalizeX + normalizeY*normalizeY < 64){
			aimX=aimXOld;
			aimY=aimYOld;
			}
                    aimXOld = aimX;
                    aimYOld = aimY;
if ((!isSpectating) && (freeze == true)) {
 aimX = offsetX;
 aimY = offsetY;
 }
                    var flag=SPACE+Q+QRELEASE+W+WBOT+SPACEBOT+SPECTATE+(NICK===0?0:128)+(CHAT===0?0:256);
                    var length=8+(flag===0?0:2)+(NICK===0?0:1+NICK.length*2)+(CHAT===0?0:1+CHAT.length*2);
                    var output = createBuffer(length);
                    output.setInt32(0, aimX, true);
                    output.setInt32(4, aimY, true);
					if(flag!==0){
                    output.setUint16(8, flag, true);
					var offset=10;
					if(NICK!==0){
					output.setUint8(offset++,NICK.length);
					for (var i=0; i < NICK.length; i++) {
                output.setUint16(offset, NICK.charCodeAt(i), true);
				offset+=2;
                    }
					}
					if(CHAT!==0){
					output.setUint8(offset++,CHAT.length);
					for (var i=0; i < CHAT.length; i++) {
                output.setUint16(offset, CHAT.charCodeAt(i), true);
				offset+=2;
                    }
					}
					SPACE = Q = QRELEASE = W = WBOT = SPACEBOT = SPECTATE = CHAT = NICK = 0;
					}
                    socketWrite(output);
		    spectclick == false;
//console.log("upd");
                }
            }
    }
    /**
     * @return {undefined}
     */
    function sendNick() {
        if (isSocketOpen() && null != nick) {
		myprevnick = nick;
            NICK=nick;
        }
    }

    function sendPass() {
        if (isSocketOpen() && "" != pass) {
            var ret = createBuffer(1 + 2 * pass.length);
            ret.setUint8(0, 77);
            /** @type {number} */
            var i = 0;
            for (; i < pass.length; ++i) {
                ret.setUint16(1 + 2 * i, pass.charCodeAt(i), true);
            }
            socketWrite(ret);
        }
    }




    function sendChat(str) {
	var nni = htmlspecialchars($('#nick').val()).toLowerCase(); 
 	if (supermods.indexOf(nni) == -1) {
	if ((myla == str) && (str.substr(0,1) != '/')) {
		if (str != '***playerenter***') {


var verif = '';
mod = '';
var escnik = htmlspecialchars($('#nick').val());

if (supernames.indexOf(escnik.toLowerCase()) != -1) { verif = '<span class="verified"></span>'; }


        var mg = "<div>" + verif + "<strong style='color:" + mycolo + "' >" + $('#nick').val() + ":</strong> " + str.substr(0,str.length-4) + "</div>";
	$("#chatlog").append(mg);
	if (jQuery('#chatlog div').length > chathistory) { jQuery('#chatlog div').eq(0).remove(); }
	$("#chatlog").scrollTop(500000);

			 $("#chat_textbox").attr("disabled","disabled").hide();
			 setTimeout('$("#chat_textbox").show(100).removeAttr("disabled")', 3000);
			 return;
		}
	}
	}


	var ctime = readCookie("lastchat");
	if (ctime == '0') {
		var ctime = new Date().getTime();
	}
	var nowtime = new Date().getTime();
	var ago = nowtime - ctime;
        if (isSocketOpen() && (str.length < 200) && (str.length > 0) && ((ago > 5000) || (supermods.indexOf(nni) != -1)) ) {
	 myla = str;
         CHAT=str;
	 createCookie('lastchat',new Date().getTime(),999);
	 if (supermods.indexOf(nni) == -1) {
		 $("#chat_textbox").attr("disabled","disabled").hide();
		 setTimeout('$("#chat_textbox").show(100).removeAttr("disabled")', 3000);
		}
        }
    }


    window.sendChat = sendChat;


    /**
     * @return {?}
     */
    function isSocketOpen() {
        return null != socket && socket.readyState == socket.OPEN;
    }
    /**
     * @param {number} id
     * @return {undefined}
     */
    function sendPacket(id) {
        if (isSocketOpen()) {
            var ret = createBuffer(1);
            ret.setUint8(0, id);
            socketWrite(ret);
        }
    }
    /**
     * @return {undefined}
     */
    function tick() {
        draw();
        win.requestAnimationFrame(tick);
    }
    /**
     * @return {undefined}
     */
    function onResize() {
        /** @type {number} */
        width = win.innerWidth;
        /** @type {number} */
        height = win.innerHeight;
        /** @type {number} */
        cv.width = canvas.width = width;
        /** @type {number} */
        cv.height = canvas.height = height;
        draw();
    }
    /**
     * @return {?}
     */
    function unitRatio() {
        return Math.max(height / 1080, width / 1920) * zoom;
    }
    /**
     * @return {undefined}
     */
    function updateRatio() {
        if (0 != playerGroup.length) {
            /** @type {number} */
            var size = 0;
            /** @type {number} */
            var i = 0;
            for (; i < playerGroup.length; i++) {
                size += playerGroup[i].size;
            }
            /** @type {number} */
            size = Math.pow(Math.min(64 / size, 1), 0.4) * unitRatio();
            /** @type {number} */
            ratio = (9 * ratio + size) / 10;
        }
    }
    /**
     * @return {undefined}
     */
	 //var glob_img = new Image();
	 //glob_img.src = "http://www.lenagold.ru/fon/geom/kle/sin/sinklet05.jpg";
	 
    function draw() {
        var playerHeight;
        /** @type {number} */
        var timestamp = Date.now();
        ++qweB;
        /** @type {number} */
        timestampLastDraw = timestamp;
        if (0 < playerGroup.length) {
            updateRatio();
            /** @type {number} */
            var playerWidth = playerHeight = 0;
            /** @type {number} */
            var i = 0;
            for (; i < playerGroup.length; i++) {
                playerGroup[i].updatePos();
                playerHeight += playerGroup[i].x / playerGroup.length;
                playerWidth += playerGroup[i].y / playerGroup.length;
            }
            /** @type {number} */
            middleX = playerHeight;
            /** @type {number} */
            middleY = playerWidth;
            chunk = ratio;
            /** @type {number} */
            offsetX = (offsetX + playerHeight) / 2;
            /** @type {number} */
            offsetY = (offsetY + playerWidth) / 2;
        } else {
            /** @type {number} */
            offsetX = (29 * offsetX + middleX) / 30;
            /** @type {number} */
            offsetY = (29 * offsetY + middleY) / 30;
            /** @type {number} */
            ratio = (9 * ratio + chunk * unitRatio()) / 10;
        }
        update();
	if (!isSpectating) {
          updateMouseAim();
	}
        if (!isAcidMode) {
            ctx.clearRect(0, 0, width, height);
        }
        if (isAcidMode) {
            /** @type {string} */
            ctx.fillStyle = isDarkTheme ? "#111111" : "#F2FBFF";
            /** @type {number} */
            ctx.globalAlpha = 0.05;
            ctx.fillRect(0, 0, width, height);
            /** @type {number} */
            ctx.globalAlpha = 1;
        } else {
            drawGrid();
        }
        list.sort(function(a, b) {
            return a.size == b.size ? a.id - b.id : a.size - b.size;
        });
        ctx.save();
        ctx.translate(width / 2, height / 2);
        ctx.scale(ratio, ratio);
        ctx.translate(-offsetX, -offsetY);

            drawBorders(ctx);
			
			/*backgroundSize = 1024;
			
			for(j=0;j<Math.round(maxY/backgroundSize)+1;j++){
				for(i=0;i<Math.round(maxX/backgroundSize)+1;i++){
					ctx.beginPath();
					var bx=i*backgroundSize;
					var by=j*backgroundSize;
					var bwsize=backgroundSize;
					var bhsize=backgroundSize;
					ctx.drawImage(glob_img,bx,by,bwsize,bhsize);
				}
			}	*/

        /** @type {number} */
        myMass = Math.min.apply(null, playerGroup.map(function(r) { //XXX
            return r.getMass();
        }));
        /** @type {number} */
        i = 0;
        for (; i < sprites.length; i++) {
            sprites[i].draw(ctx);
        }
        /** @type {number} */
        i = 0;
        for (; i < list.length; i++) {
            list[i].draw(ctx);
        }
        if (isTargeting) {
            /** @type {number} */

//console.log("1", targetBufferX,targetBufferY);

//            targetBufferX = (3 * targetBufferX + targetX) / 4;
            /** @type {number} */
 //           targetBufferY = (3 * targetBufferY + targetY) / 4;
            ctx.save();

//console.log("2", targetBufferX,targetBufferY);

            /** @type {string} */
            ctx.strokeStyle = "#FFAAAA";
            /** @type {number} */
            ctx.lineWidth = 10;
            /** @type {string} */
            ctx.lineCap = "round";
            /** @type {string} */
            ctx.lineJoin = "round";
            /** @type {number} */
            ctx.globalAlpha = 0.3;
            ctx.beginPath();
            /** @type {number} */
            i = 0;
            for (; i < playerGroup.length; i++) {
                ctx.moveTo(playerGroup[i].x, playerGroup[i].y);
                ctx.lineTo(targetBufferX, targetBufferY);
            }
            ctx.stroke();
            ctx.restore();
        }
        ctx.restore();
        if (img) {
            if (img.width) {
                ctx.drawImage(img, width - img.width - 10, 10);
            }
        }
        OnDraw(ctx);
        /** @type {number} */
        score = Math.max(score, getScore());
        if (0 != score) {
            if (null == button) {
                button = new SVGPlotFunction(20, "#FFFFFF");
            }
			var debug="";
			if(latency)debug="FPS: "+serverFPS+" Up: "+loadUp+"KB/s Down: "+loadDown+"KB/s";
            button.setValue("x:" + ~~(offsetX-minX) + " y:" + ~~(offsetY-minY) + ". Максимум: " + Math.floor(score / 100) + ". Сейчас: " + Math.floor(getScore() / 100) + " (" + playerGroup.length + ")"+debug);

            playerWidth = button.render();
            playerHeight = playerWidth.width;
            /** @type {number} */
            ctx.globalAlpha = 0.5;
            /** @type {string} */
            ctx.fillStyle = "#2a6496";
            ctx.fillRect(10, height - 10 - 22 - 10, playerHeight + 10, 34);
            /** @type {number} */
            ctx.globalAlpha = 1;
            ctx.drawImage(playerWidth, 15, height - 10 - 20 - 5);

		if ((playerGroup) && playerGroup[0]) {
		OnUpdateMass(getScore());
		//UpdateChart(~~(getScore() / 100), GetRgba(playerGroup[0].color, 0.4));
		}

        }


        if (isSpectating) {
            if (null == button) {
                button = new SVGPlotFunction(20, "#FFFFFF");
            }
            button.setValue("*** Наблюдение:  *** x:" + ~~(middleX) + " y:" + ~~(middleY));

            playerWidth = button.render();
            playerHeight = playerWidth.width;
            /** @type {number} */
            ctx.globalAlpha = 0.5;
            /** @type {string} */
            ctx.fillStyle = "#2a6496";
            ctx.fillRect(10, height - 10 - 22 - 10, playerHeight + 10, 34);
            /** @type {number} */
            ctx.globalAlpha = 1;
            ctx.drawImage(playerWidth, 15, height - 10 - 20 - 5);
        }


        drawSplitButton();
        /** @type {number} */
        timestamp = Date.now() - timestamp;
        if (timestamp > 1E3 / 60) {
            renderDetail -= 0.01;
        } else {
            if (timestamp < 1E3 / 65) {
                renderDetail += 0.01;
            }
        }
        if (0.4 > renderDetail) {
            /** @type {number} */
            renderDetail = 0.4;
        }
        if (1 < renderDetail) {
            /** @type {number} */
            renderDetail = 1;
        }
    }
    /**
     * @return {undefined}
     */
    function drawGrid() {



        /** @type {string} */
        ctx.fillStyle = isDarkTheme ? "#111111" : "#F2FBFF";
        ctx.fillRect(0, 0, width, height);
        ctx.save();
	if (!isHideGrid && ratio>0.02) {
	        /** @type {string} */
	        ctx.strokeStyle = isDarkTheme ? "#AAAAAA" : "#000000";
	        /** @type {number} */
	        ctx.globalAlpha = 0.2;
	        ctx.scale(ratio, ratio);
	        /** @type {number} */
	        var gridOffsetX = width / ratio;
	        /** @type {number} */
 	       var gridOffsetY = height / ratio;
 	       /** @type {number} */
	       ctx.beginPath(); // фикс1
 	       var y = -0.5 + (-offsetX + gridOffsetX / 2) % 50;
 	       for (; y < gridOffsetX; y += 50) {
	            //ctx.beginPath();
        	    ctx.moveTo(y, 0);
	            ctx.lineTo(y, gridOffsetY);
        	    //ctx.stroke();
	        }
        	/** @type {number} */
	        y = -0.5 + (-offsetY + gridOffsetY / 2) % 50;
	        for (; y < gridOffsetY; y += 50) {
	            //ctx.beginPath();
	            ctx.moveTo(0, y);
	            ctx.lineTo(gridOffsetX, y);
	            //ctx.stroke();
	        }
		ctx.stroke();//фикс2
	}
        ctx.restore();


    }
    /**
     * @return {undefined}
     */
    function drawSplitButton() {
        if (isMobile && imageSplitButton.width) {
            /** @type {number} */
            var dim = width / 5;
            ctx.drawImage(imageSplitButton, 5, 5, dim, dim);
        }
    }
    /**
     * @return {?}
     */
    function getScore() {
        /** @type {number} */
        var value = 0;
        /** @type {number} */
        var i = 0;
        for (; i < playerGroup.length; i++) {
            value += playerGroup[i].nSize * playerGroup[i].nSize;
        }
        return value;
    }
    /**
     * @return {undefined}
     */
    function render() {
        /** @type {null} */
        img = null;
        if (null != angles || 0 != users.length) {
            if (null != angles || isNames) {
                /** @type {Element} */
                img = document.createElement("canvas");
                var ctx = img.getContext("2d");
                var i = 60;
                i = null == angles ? i + 24 * users.length : i + 180;
               // var qweU = Math.min(200, 0.3 * width) / 200;

		var hty = window.selmode;
		var lbwidth = 200;
		if (hty == "BLACKHOLE") { lbwidth = 260; } 
		if (hty == "ARENA") { lbwidth = 220; } 
		if (hty == "FATBOY-ARENA") { lbwidth = 220; } 
		if (hty == "DEATHMATCH") { lbwidth = 250; } 
		var qweU = Math.min(lbwidth, 0.3 * width) / lbwidth;
		img.width = lbwidth * qweU;
                img.height = i * qweU;
                ctx.scale(qweU, qweU);
                ctx.globalAlpha = 0.5;
                ctx.fillStyle = "#2a6496";
                ctx.fillRect(0, 0, lbwidth, i);
                ctx.globalAlpha = 1;
                ctx.fillStyle = "#FFFFFF";
                var qweV = "Top bitches";
		if (settedlang != 'en') { var qweV = "Топ чашки"; }

		if ((hty == "ARENA") || (hty == "FATBOY-ARENA") || (hty == "ZOMBIE-FFA")) {
			var qweV = "Game status";
			if (settedlang != 'en') { var qweV = "Статус матча"; }
		}

		if (hty == "TEAM") {
			var qweV = "Top teams";
			if (settedlang != 'en') { var qweV = "Топ команд"; }
		}

		if (hty == "DEATHMATCH") {
			var qweV = "Top frags";
			if (settedlang != 'en') { var qweV = "Топ фрагов"; }
		}

		if (hty == "BLACKHOLE") {
			var qweV = "Black Mass Top";
			if (settedlang != 'en') { var qweV = "Топ чёрной дыры"; }
		}


// my fix 
if ((hty == "ARENA") || (hty == "FATBOY-ARENA")) { 
	if (users[0]) {
		if ((users[0].name != "Waiting for") && (!isSpectating) && (playerGroup.length == 0)) { 
			setSpectate(false);
	                SPECTATE = 64;
			setSpectate(true);
			jQuery("#playBtn").css("float","left").css("width","255px");
			jQuery("#spectateBtn").show();
			jQuery("#specbutton").show();
			setNick(document.getElementById('nick').value/* + ":::::" + document.getElementById('password').value + ":::::" + document.getElementById('color').value*/); 
                	SPECTATE = 64;
		}
	}
}

                /** @type {string} */
                ctx.font = "30px Ubuntu";
                ctx.fillText(qweV, lbwidth/2 - ctx.measureText(qweV).width / 2, 40);
                if (null == angles) {
                    /** @type {string} */
                    ctx.font = "20px Ubuntu";
                    /** @type {number} */
                    i = 0;
                    for (; i < users.length; ++i) {
                        qweV = users[i].name || "An unnamed cell";

			if ((hty == "ARENA") || (hty == "FATBOY-ARENA")) {
				if (settedlang != 'en') {
				 if (users[i].name == 'Waiting for') { qweV = 'Идёт набор'; }
				 if (users[i].name == 'players: ') { qweV = 'игроков:'; }
				 if (users[i].name.substr(0,10) == 'Human mini') { 
					var spfsp = users[i].name.split(" ");
					qweV = 'Минимум людей: ' + spfsp[2]; 
					}
				 if (users[i].name == 'Human minimum: ok!') { qweV = 'Минимум набран!'; }
				 if (users[i].name == 'Bots will be added') { qweV = 'Боты войдут в игру'; }
				 if (users[i].name.substr(0,3) == 'in ') { 
					var spfsp = users[i].name.split(" ");
					qweV = 'через  ' + spfsp[1] + ' сек.';
					}
				 if (users[i].name == 'Game in progress!') { qweV = 'Идёт матч!'; }
				 if (users[i].name == 'Players remaining') { qweV = 'Осталось игроков:'; }
				 if (users[i].name == 'Game starting in') { qweV = 'Игра начнется через'; }
				 if (users[i].name == 'Good luck!') { qweV = 'Удачи игрокам!'; }
				 if (users[i].name == 'Congratulations') { qweV = 'Поздравляем'; }
				 if (users[i].name == 'for winning!') { qweV = 'с победой!'; }
				 if (users[i].name.substr(0,8) == '(Started') { 
					var spfsp = users[i].name.split(" ");
					qweV = '(' + spfsp[2] + '  ботов на старте)';
					}
				 if (users[i].name == 'Final battle!') { qweV = 'Финальная битва!'; }
				 if (users[i].name == 'vs.') { qweV = 'против'; }
				 if (users[i].name == 'Time left:') { qweV = 'Осталось времени:'; }
				 if (users[i].name == 'Next game in') { qweV = 'Рестарт через'; }
				 if (users[i].name == '10 seconds') { qweV = '10 секунд'; }
				 if (users[i].name == '9 seconds') { qweV = '9 секунд'; }
				 if (users[i].name == '8 seconds') { qweV = '8 секунд'; }
				 if (users[i].name == '7 seconds') { qweV = '7 секунд'; }
				 if (users[i].name == '6 seconds') { qweV = '6 секунд'; }
				 if (users[i].name == '5 seconds') { qweV = '5 секунд'; }
				 if (users[i].name == '4 seconds') { qweV = '4 секунды'; }
				 if (users[i].name == '3 seconds') { qweV = '3 секунды'; }
				 if (users[i].name == '2 seconds') { qweV = '2 секунды'; }
				 if (users[i].name == '1 seconds') { qweV = '1 секунду'; }
				 if (users[i].name == '0 seconds') { qweV = '0 секунд'; }
				 if (users[i].name == 'The fattest will win!') {qweV = 'Победа будет по массе';}
				}
			}

			if (hty == "ZOMBIE-FFA") {
				if (settedlang != 'en') {
				 if (i == 0) {qweV = "Осталось: " + qweV; }
				 if (users[i].name == 'WAITING FOR') { qweV = 'Идёт набор'; }
				 if (users[i].name == 'PLAYERS...') { qweV = 'игроков...'; }
				 if (users[i].name == 'HUMAN WINS') { qweV = 'Победа людей!'; }
				 if (users[i].name == 'ZOMBIE WINS') { qweV = 'Победа зомби!'; }
				 if (users[i].name == 'GAME STARTS IN:') { qweV = 'Рестарт через:'; }
				 if (users[i].name.substr(0,6) == 'HUMAN:') { 
					var spfsp = users[i].name.split(" ");
					qweV = 'ЛЮДЕЙ: ' + spfsp[1];
					}
				 if (users[i].name.substr(0,7) == 'ZOMBIE:') { 
					var spfsp = users[i].name.split(" ");
					qweV = 'ЗОМБИ: ' + spfsp[1];
					}
				 if (users[i].name == 'Human minimum: ok!') { qweV = 'Минимум набран!'; }
				}
			}

                        if (!isNames) {
                            /** @type {string} */
                            qweV = "An unnamed cell";
                        }
                        if (users[i].id==1) {
                            ctx.fillStyle = "#FFAAAA";
				OnLeaderboard(i + 1);
                        } else {
                            ctx.fillStyle = "#FFFFFF";
                        }

// my fix #2
if ((hty != "ARENA") && (hty != "FATBOY-ARENA") && (hty != "ZOMBIE-FFA")) { 
	        qweV = i + 1 + ". " + qweV;
		ctx.fillText(qweV, 5, 70 + 24 * i);
} else {
                        ctx.fillText(qweV, lbwidth/2 - ctx.measureText(qweV).width / 2, 70 + 24 * i); }
                    }

                } else {
                    /** @type {number} */
                    var qweW = 0;
                    /** @type {number} */
                    i = 0;
                    for (; i < angles.length; ++i) {
                        /** @type {number} */
                        var qweX = qweW + angles[i] * Math.PI * 2;
                        ctx.fillStyle = qweH[i + 1];
                        ctx.beginPath();
                        ctx.moveTo(100, 140);
                        ctx.arc(100, 140, 80, qweW, qweX, false);
                        ctx.fill();
                        /** @type {number} */
                        qweW = qweX;
                    }
                }
            }
        }
    }
    /**
     * @param {Function} id
     * @param {number} x
     * @param {number} y
     * @param {number} size
     * @param {string} color
     * @param {string} name
     * @return {undefined}
     */
    function Blob(id, x, y, size, color, name) {
        /** @type {Function} */
        this.id = id;
        this.ox = this.x = x;
        this.oy = this.y = y;
        this.oSize = this.size = size;
        /** @type {string} */
        this.color = color;
        /** @type {Array} */
        this.points = [];
        /** @type {Array} */
        this.pointsAcc = [];
        this.createPoints();
        this.setName(name);
    }
    /**
     * @param {number} size
     * @param {string} color
     * @param {?} stroke
     * @param {string} strokeColor
     * @return {undefined}
     */
    function SVGPlotFunction(size, color, stroke, strokeColor) {
        if (size) {
            /** @type {number} */
            this._size = size;
        }
        if (color) {
            /** @type {string} */
            this._color = color;
        }
        /** @type {boolean} */
        this._stroke = !!stroke;
        if (strokeColor) {
            /** @type {string} */
            this._strokeColor = strokeColor;
        }
    }


    var bordersImagesCached = {};
    var bordersImages = {
        'IP': 'IMG.PNG'
    };


    /**
     * @param {(Object|null)} ctx
     * @return {undefined}
     */
    function drawBorders(ctx) { //XXX
//        if (isDarkTheme) {
            /** @type {string} */
 //           ctx["strokeStyle"] = "#FFFFFF";
 //       }
 //       ctx.beginPath();
 //       ctx.moveTo(0, 0); //TODO use min/max X/Y
 //       ctx.lineTo(11180, 0);
 //       ctx.lineTo(11180, 11180);
 //       ctx.lineTo(0, 11180);
 //       ctx.lineTo(0, 0);
 //       ctx.stroke();

        var selectedRegion = socketaddr.substr(5,socketaddr.length),
            logoimage;
        if(bordersImagesCached[selectedRegion]) {
            logoimage = bordersImagesCached[selectedRegion];
        } else {
            bordersImagesCached[selectedRegion] = logoimage = new Image;
            logoimage.src = bordersImages[selectedRegion] || "/index_files/img/petriserverlogo.png";
        }



var dim = width / 2;
//ctx.drawImage(logoimage, maxX/2-dim/2, maxX/2-dim/2, dim, dim);

    }
    /** @type {string} */
    var protocol = win.location.protocol;
    /** @type {boolean} */
    var isSecure = "https:" == protocol;
    if (1 == 2) {

    } else {
        var cv;
        var ctx;
        var canvas;
        var width;
        var height;
        /** @type {null} */
        var context = null;
        /** @type {null} */
        var socket = null;
        /** @type {number} */
        var offsetX = 0;
        /** @type {number} */
        var offsetY = 0;
        /** @type {Array} */
        var ids = [];
        /** @type {Array} */
        //var playerGroup = [];

	var chatBoard = [];

        var blobs = {};
        /** @type {Array} */
        var list = [];
        /** @type {Array} */
        var sprites = [];
        /** @type {Array} */
        var users = [];
        /** @type {number} */
        var mouseX = 0;
        /** @type {number} */
        var mouseY = 0;
        /** @type {number} */
        var aimX = -1;
        /** @type {number} */
        var aimY = -1;
        /** @type {number} */
        var qweB = 0;
        /** @type {number} */
        var timestampLastDraw = 0;
        /** @type {null} */
        var nick = null;
        var pass = null;
        /** @type {number} */
        var minX = 0;
        /** @type {number} */
        var minY = 0;
        /** @type {number} */
        var maxX = 1E4;
        /** @type {number} */
        var maxY = 1E4;
        /** @type {number} */
        var ratio = 1;
        /** @type {null} */
        var region = null;
        /** @type {boolean} */
        var isSkins = true;
        /** @type {boolean} */
        var isNames = true;
        /** @type {boolean} */
        var isColorsOff = false;
        /** @type {boolean} */
        var qweA = false;
        /** @type {number} */
        var score = 0;
        /** @type {boolean} */
        var isDarkTheme = false;
        /** @type {boolean} */
        var isShowMass = true; //XXX
        /** @type {number} */
        var middleX = offsetX = ~~((minX + maxX) / 2);
        /** @type {number} */
        var middleY = offsetY = ~~((minY + maxY) / 2);
        /** @type {number} */
        var chunk = 1;
	var hasOverlay = true;
        /** @type {string} */
        var gameMode = "";
        /** @type {null} */
        var angles = null;
        /** @type {boolean} */
        var initialized = false;
        /** @type {boolean} */
//        var isTargeting = false;
        /** @type {number} */
        var targetX = 0;
        /** @type {number} */
        var targetY = 0;
        /** @type {number} */
        //var targetBufferX = 0;
        /** @type {number} */
        //var targetBufferY = 0;
        /** @type {number} */
        var previousKey = 0;
        /** @type {Array} */
        var qweH = ["#333333", "#FF3333", "#33FF33", "#3333FF"];
        /** @type {boolean} */
        var isAcidMode = false;
        /** @type {number} */
        var zoom = 1;
        /** @type {boolean} */
        var isMobile = "ontouchstart" in win && /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        /** @type {Image} */
        var imageSplitButton = new Image;
        /** @type {string} */
        imageSplitButton.src = "/index_files/img/split.png";
        /** @type {Element} */
        var test_canvas = document.createElement("canvas");
        if ("undefined" == typeof console || ("undefined" == typeof DataView || ("undefined" == typeof WebSocket || (null == test_canvas || (null == test_canvas.getContext || null == win.localStorage))))) {
            alert("You browser does not support this game, we recommend you to use Firefox to play this");
        } else {
            /** @type {null} */
            var regions = null;
            /**
             * @param {Function} input
             * @return {undefined}
             */
            win.setNick = function(input) {
                if (isSpectating) { //XXX
                    spectate();
                } else {
                    hide();
                    /** @type {Function} */
                    nick = input;
                }
                sendNick();
                /** @type {number} */
                if(playerGroup.length==0)score = 0;
//console.log(input);
            };
            win.setPass = function(input) {
                if (isSpectating) { //XXX
                    spectate();
                } else {
                    hide();
                    /** @type {Function} */
                    pass = input;
                }
                sendPass();
                /** @type {number} */
//console.log(input);
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            win.setSkins = function(input) {
                /** @type {boolean} */
                isSkins = input;
            };
            /**
             * @param {string} input
             * @return {undefined}
             */
            win.setNames = function(input) {
                /** @type {string} */
                isNames = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            win.setDarkTheme = function(input) {
                /** @type {boolean} */
                isDarkTheme = input;
		if (input == true) { $("#chatlog").removeClass("whitechat").addClass("blackchat"); }
		if (input == false) { $("#chatlog").removeClass("blackchat").addClass("whitechat"); }
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            win.setColorsOff = function(input) {
                /** @type {boolean} */
                isColorsOff = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            win.setShowMass = function(input) {
                /** @type {boolean} */
                isShowMass = input;
            };
            /**
             * @return {undefined}
             */
            win.spectate = function() {
                /** @type {null} */
                nick = null;
                SPECTATE = 64;
                hide();
            };
            /**
             * @param {string} input
             * @return {undefined}
             */
            win.setGameMode = function(input) {
                if (input != gameMode) {
                    /** @type {string} */
                    gameMode = input;
                    connect();
                }
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            win.setAcid = function(input) {
                /** @type {boolean} */
                isAcidMode = input;
            };
            if (null != win.localStorage) {
                if (null == win.localStorage.AB8) {
                    /** @type {number} */
                    win.localStorage.AB8 = 0 + ~~(100 * Math.random());
                }
                /** @type {number} */
                previousKey = +win.localStorage.AB8;
                /** @type {number} */
                win.ABGroup = previousKey;
            }
            /** @type {function (string): undefined} */
            win.connect = open;
            /** @type {number} */
            var backoff = 500;
            /** @type {number} */
            var aimXOld = -1;
            /** @type {number} */
            var aimYOld = -1;
            /** @type {null} */
            var img = null;
            /** @type {number} */
            var renderDetail = 1;
            /** @type {null} */
            var button = null;
            var images = {};
            /** @type {Array.<string>} */



 var qweI = ['бублик','pac-man','petri wars','8','nasa','alexx876','ilitarium','васян','илитариум','wat','рубль','dollar','euro','евро','доллар','бакс','петри','petri','dish','чашка','helo kitty','шурик','будь мужиком!','кошка','ｅｌｉｔｅ','lemon 3/4','шурик','sad boys','eugenesagaz','боженька','gamer pro','4pda','mr.makintosh','joyeux noel','#imp bardak™','light of life.','vault 101','lain','umbrella','миф','крутышка я','супер пупер пц','','sanyakosmos','ďąᏉẏĵøȵêš','admin','nezox','edinorog1','djkopatыч','peugeot','memory ✔','wowwowwow','₱ἡὠ∑₦ψx™','death hand','клякса','b1ll c1ph3r','','kлякса','кляксa','сычуга','truebandit','monster energy','король и шут','βіkøċ','инсайдер','mŗ.ē√ϊł','torment','cøquille','homer','life.','xobbut','spaceman','сосед','ingenious','будь мужиком!','','poulou68','чупик','patяrick','v l a d','spécialvip','подрывник','jvroad','kraken','niggor233','король шутов','mazay','mangas','neznakomka','альфа','♤ɓḽẫḉҝĵẫḉҝ♤','','obvmv','galacy','catwomen','galaxy','winchester','hуþer.','pitbull','гггг','thunderbird','guardian','xj500','mister_kayne','s3r3nity','nicodocktv','p e r f e c t','nicodocktv1','клякca','тяжело','2руки2клешни','сип','skreeper','stasplex','devianz','laracroft','celestial.','çŕàžý_ďàńťĭśť','black fuck','','kyrag','virus','mindanddream','егэ','jummu','๖ۣۣۜrio','chappie','...-','virus1','test123','s p a c e','۞ҳσŗ¥ą۞','adventypa','б ® δ †','daf','angeal2','welcome to hell','|ffff|блэкджек','snow','алан вей','fl1ke','cantstopme','†голенькая†','ᴇᴀsᴛ ᴡᴀvᴇ','doc tv','шура','s w e e t','°•☆★random★☆•°','šaρρhire','bean07','play for paris','mralexpro26099','tvplush','the оскар','стюардесса','пилот','s m i l e','спартакмосква','power','[kaio]','⋰ Ꮶ ⋱','štǿrm','snif','betrayal','wildman','johnlock','зайййка[72rus]','mariano','+79513188247','сёмa','#cjlonik_pro','#zik_pro','vnvx','şάńê™','ẵώể౭σmě™','yellow claw','привеет!','noеl','l i o n e','petit prince','ទេវតារបស់វីង','✖ c h i l i e ✖','✖ n i g h t','spoody man','voyloness.','federal☻','∂εαтн','kakashi','большаяляля','spécialnd','☜❶☞ясная☜❶☞','lovely','silver','опасный','neverland','жена князева','crywolf','endless ocean','g r e m o r y','indefix','ranaara','topplayersnd','*hiri','корра','n.squad','impossible.','teamnd','dead.','meow with you','','forthequeen!','[zаw+]porsche','самурай','ｂａｇｉｒａ','kuik','соло','little angel','lighthouse.','дом в глуши','trimano','nadesyo','liska','я+','chucky','tiffany','★ќуķờĺķǻ★','ŧђє≈þ®ø','thomas','saoloa2','[go]ŧℰ₳ℳℙℜø☠','ŧℰ₳ℳℙℜø☠✞','virginie','gaaralexander','непокорённый','just1ce','ɗĭḿᗩśϒ™','vipalex','√theripper','djoker','godzilla','лагуна','françois +18','☛ℕℑᏩᏩᎯ☚','гай фокс','300alexander','šúňłíğȟŧ','paradise','〖ɓîłᗫ〗mašŧéř','dr.wesker','✞дисфория✞','night vision','полина☯','возраст','котяра','симба','aprøfen','deep...','nelsa','dukkha','ღ♕neznakomka♕ღ','✞бро✞','hogo','создатель bild','катя чехова','trimano1','headshot','ŧℰ₳ℳℙℜø','jae','litost','че тебе нужно?','ŧℰ₳ℳℙℜø☠','❆мɐҫκẵ❆','портал','zazin [1]','твой любимка','иииии','#jesusnezna','yannickvbeta','jeje2','dream is dead','nico-for-test','noel','ćolđ bl❍❍đ †','ɗℐℒᎯŋ','☣☣şράŕţά☣☣','nеzna','satana666','๖ۣۣۜflowed','snif 2','snif3','snif 4','snif 5','(⌐■_■)007','evan','♫♛฿аðίм♛♫','๖ۣۣۜremove','žłōŷ','я - легенда.','ŧờⓈħҝå','a.k.k.b.','şḧãҟäɫ (¬‿¬)','šcǿrpiǿn','предвестник.','✟ðξʍტℕ✟','mumbojumbo','۩₣ļèŷعŗ۩','ŧტšħ₭ǻ','umagical','ilove','faxer','ебашим топ?','๖ۣۣۜf o x y ﮐ','cosmorection','wyleass','๒lเςร๏ฬ','blicsow2','snoww','ruby rhod'];

﻿
            var skinsSpecial = ["m'blob"];
	    var transp = ['бублик','pac-man'];
	    var animated = ['mangoo','pac-man','noel','nеzna'];
            Blob.prototype = {
                id: 0,
                points: null,
                pointsAcc: null,
                name: null,
                nameCache: null,
                sizeCache: null,
                x: 0,
                y: 0,
                size: 0,
                ox: 0,
                oy: 0,
                oSize: 0,
                nx: 0,
                ny: 0,
                nSize: 0,
                flags: 0,
                updateTime: 0,
                updateCode: 0,
                drawTime: 0,
                destroyed: false,
                isVirus: false,
                isAgitated: false,
                wasSimpleDrawing: true,
				colorID: 0,
                /**
                 * @return {undefined}
                 */
                destroy: function() {
                    var i;
                    /** @type {number} */
                    i = 0;
                    for (; i < list.length; i++) {
                        if (list[i] == this) {
                            list.splice(i, 1);
                            break;
                        }
                    }
                    delete blobs[this.id];
                    i = playerGroup.indexOf(this);
                    if (-1 != i) {
                        /** @type {boolean} */
                        qweA = true;
                        playerGroup.splice(i, 1);
                    }
                    i = ids.indexOf(this.id);
                    if (-1 != i) {
                        ids.splice(i, 1);
                    }
                    /** @type {boolean} */
                    this.destroyed = true;
                    sprites.push(this);
                },
                /**
                 * @return {?}
                 */
                getNameSize: function() {
                    if (isLargeNames) { //XXX
                        return 50 + 0.3 * this.size;
                    } else {
                        return Math.max(~~(0.3 * this.size), 24);
                    }
                },
                /**
                 * @param {string} name
                 * @return {undefined}
                 */
                setName: function(name) {
                    if (this.name = name) {
                        if (null == this.nameCache) {
                            this.nameCache = new SVGPlotFunction(this.getNameSize(), "#FFFFFF", true, "#000000");
                        } else {
                            this.nameCache.setSize(this.getNameSize());
                        }
                        this.nameCache.setValue(this.name);
                    }
                },
                /**
                 * @return {undefined}
                 */
                createPoints: function() {
                    var max = this.getNumPoints();
                    for (; this.points.length > max;) {
                        /** @type {number} */
                        var i = ~~(Math.random() * this.points.length);
                        this.points.splice(i, 1);
                        this.pointsAcc.splice(i, 1);
                    }
                    if (0 == this.points.length) {
                        if (0 < max) {
                            this.points.push({
                                self: this,
                                size: this.size,
                                x: this.x,
                                y: this.y
                            });
                            this.pointsAcc.push(Math.random() - 0.5);
                        }
                    }
                    var point;
                    for (; this.points.length < max;) {
                        /** @type {number} */
                        i = ~~(Math.random() * this.points.length);
                        point = this.points[i];
                        this.points.splice(i, 0, {
                            self: this,
                            size: point.size,
                            x: point.x,
                            y: point.y
                        });
                        this.pointsAcc.splice(i, 0, this.pointsAcc[i]);
                    }
                },
                /**
                 * @return {?}
                 */
                getNumPoints: function() {
                    if (0 == this.id) {
                        return 16;
                    }
                    /** @type {number} */
                    var rh = 10;
                    if (20 > this.size) {
                        /** @type {number} */
                        rh = 0;
                    }
                    if (this.isVirus) {
                        /** @type {number} */
                        rh = 30;
                    }
                    /** @type {number} */
                    var w = this.size;
                    if (!this.isVirus) {
                        w *= ratio;
                    }
                    w *= renderDetail;
                    if (this.flags & 32) {
                        w *= 0.25;
                    }
                    return ~~Math.max(w, rh);
                },
                /**
                 * @return {undefined}
                 */
                movePoints: function() {
                    this.createPoints();
                    var points = this.points;
                    var pointsAcc = this.pointsAcc;
                    var numPoints = points.length;
                    /** @type {number} */
                    var i = 0;
                    for (; i < numPoints; ++i) {
                        var qweL = pointsAcc[(i - 1 + numPoints) % numPoints];
                        var qweM = pointsAcc[(i + 1) % numPoints];
                        pointsAcc[i] += (Math.random() - 0.5) * (this.isAgitated ? 3 : 1);
                        pointsAcc[i] *= 0.7;
                        if (10 < pointsAcc[i]) {
                            /** @type {number} */
                            pointsAcc[i] = 10;
                        }
                        if (-10 > pointsAcc[i]) {
                            /** @type {number} */
                            pointsAcc[i] = -10;
                        }
                        /** @type {number} */
                        pointsAcc[i] = (qweL + qweM + 8 * pointsAcc[i]) / 10;
                    }
                    /** @type {Blob} */
                    var qweK = this;
                    /** @type {number} */
                    var qweO = 0;
                    if (!this.isVirus) {
                        /** @type {number} */
                        qweO = (this.id / 1E3 + timestampLastDraw / 1E4) % (2 * Math.PI);
                    }
                    /** @type {number} */
                    i = 0;
                    for (; i < numPoints; ++i) {
                        var size = points[i].size;
                        qweL = points[(i - 1 + numPoints) % numPoints].size;
                        qweM = points[(i + 1) % numPoints].size;
                        if (15 < this.size && (null != context && (20 < this.size * ratio && 0 != this.id))) {
                            /** @type {boolean} */
                            var qweN = false;
                            var startX = points[i].x;
                            var startY = points[i].y;
                            context.retrieve2(startX - 5, startY - 5, 10, 10, function(data) {
                                if (data.self != qweK) {
                                    if (25 > (startX - data.x) * (startX - data.x) + (startY - data.y) * (startY - data.y)) {
                                        /** @type {boolean} */
                                        qweN = true;
                                    }
                                }
                            });
                            if (!qweN) {
                                if (points[i].x < minX || (points[i].y < minY || (points[i].x > maxX || points[i].y > maxY))) {
                                    /** @type {boolean} */
                                    qweN = true;
                                }
                            }
                            if (qweN) {
                                if (0 < pointsAcc[i]) {
                                    /** @type {number} */
                                    pointsAcc[i] = 0;
                                }
                                pointsAcc[i] -= 1;
                            }
                        }
                        size += pointsAcc[i];
                        if (0 > size) {
                            /** @type {number} */
                            size = 0;
                        }
                        /** @type {number} */
                        size = this.isAgitated ? (19 * size + this.size) / 20 : (12 * size + this.size) / 13;
                        /** @type {number} */
                        points[i].size = (qweL + qweM + 8 * size) / 10;
                        /** @type {number} */
                        qweL = 2 * Math.PI / numPoints;
                        qweM = this.points[i].size;
                        if (this.isVirus) {
                            if (0 == i % 2) {
                                qweM += 5;
                            }
                        }
                        points[i].x = this.x + Math.cos(qweL * i + qweO) * qweM;
                        points[i].y = this.y + Math.sin(qweL * i + qweO) * qweM;
                    }
                },
                /**
                 * @return {?}
                 */
                updatePos: function() {
                    if (0 == this.id) {
                        return 1;
                    }
                    /** @type {number} */
                    var ratio = (timestampLastDraw - this.updateTime) / 120;
                    if (0 > ratio) {
                        /** @type {number} */
                        ratio = 0;
                    } else {
                        if (1 < ratio) {
                            /** @type {number} */
                            ratio = 1;
                        }
                    }
                    this.getNameSize();
                    if (this.destroyed && 1 <= ratio) {
                        var index = sprites.indexOf(this);
                        if (-1 != index) {
                            sprites.splice(index, 1);
                        }
                    }
                    this.x = ratio * (this.nx - this.ox) + this.ox;
                    this.y = ratio * (this.ny - this.oy) + this.oy;
                    this.size = ratio * (this.nSize - this.oSize) + this.oSize;
                    return ratio;
                },
                /**
                 * @return {?}
                 */
                shouldRender: function() {
                    if (0 == this.id) {
                        return true;
                    }
                    if (this.x + this.size + 40 < offsetX - width / 2 / ratio || (this.y + this.size + 40 < offsetY - height / 2 / ratio || (this.x - this.size - 40 > offsetX + width / 2 / ratio || this.y - this.size - 40 > offsetY + height / 2 / ratio))) {
                        return false;
                    }
                    return true;
                },
                /**
                 * @return {?}
                 */
                getMass: function() {
                    return ~~(this.size * this.size / 100);
                },
                _cachedDifference: Math.log(1.01),
                _cachedFood: {},
                /**
                 * @param {CanvasRenderingContext2D} ctx
                 * @return {undefined}
                 */
		    draw: function(ctx) {
			var isFood = false,
			x = this.x,
			y = this.y;
                    if (this.shouldRender()) {

                        if (this.size < 29 && !this.destroyed/* && this.shouldRender()*/) {
                            var key = this.color + '_' + this.size;
                            if(this._cachedFood[key]) {//если в кэше есть картинка еды - используем ее
                                ctx.drawImage(this._cachedFood[key], this.x - this.size, this.y - this.size);
                                return;
                            } else {//если еды нету в кэше - подготавливаем отдельный контекст
                                var newCanvas = document.createElement('canvas'),
                                    prevCtx = ctx;
                                newCanvas.width = newCanvas.height = this.size * 2;
                                ctx = newCanvas.getContext('2d');
				isFood = true;
                                x = this.size;
                                y = this.size;
                                this._cachedFood[key] = newCanvas;
                            }
                        }

                        var color = this.color; //XXX
//			if (this.isVirus) { color = "#FF0000"; }
                        /** @type {boolean} */
                        var isSimpleDrawing = isSimpleMode || (this.size < 24 && !isColorsOff); //XXX
                        if (5 > this.getNumPoints()) {
                            /** @type {boolean} */
                            isSimpleDrawing = true;
                        }
                        if (this.wasSimpleDrawing && !isSimpleDrawing) {
                            /** @type {number} */
                            var i = 0;
                            for (; i < this.points.length; i++) {
                                /** @type {number} */
                                this.points[i].size = this.size;
                            }
                        }
                        /** @type {boolean} */
                        this.wasSimpleDrawing = isSimpleDrawing;
                        ctx.save();
                        this.drawTime = timestampLastDraw;
                        var updatePos = this.updatePos();
                        if (this.destroyed) {
                            ctx.globalAlpha *= 1 - updatePos;
                        }
                        /** @type {number} */
                        ctx.lineWidth = isLargeBlobBorders ? 30 : 10; //XXX
                        /** @type {string} */
                        ctx.lineCap = "round";
                        /** @type {string} */
                        ctx.lineJoin = this.isVirus ? "miter" : "round";
                        if (isColorsOff) {
                            /** @type {string} */
                            ctx.fillStyle = "#FFFFFF";
                            /** @type {string} */
                            ctx.strokeStyle = "#AAAAAA";
                        } else {
                            if (":teams" == gameMode && !this.isVirus) { //XXX
                                ctx.fillStyle = this.color;
                            } else {
                                ctx.fillStyle = color;
                            }
                            ctx.strokeStyle = color; //XXX
                        }
                        if (isVirusTransparent && this.isVirus) { //XXX
                           // ctx.globalAlpha = 0.6;
                        }
			if (isSimpleDrawing) {
				ctx.beginPath();
				//ctx.arc(this.x, this.y, this.size, 0, 2 * Math.PI, false);
				ctx.arc(isFood ? x : this.x, isFood ? y : this.y, this.size, 0, 2 * Math.PI, false);
                        } else {
                            this.movePoints();
                            ctx.beginPath();
                            var numPoints = this.getNumPoints();
                            ctx.moveTo(this.points[0].x, this.points[0].y);
                            /** @type {number} */
                            i = 1;
                            for (; i <= numPoints; ++i) {
                                /** @type {number} */
                                var j = i % numPoints;
                                ctx.lineTo(this.points[j].x, this.points[j].y);
                            }
                        }
                        ctx.closePath();
                        var name = this.name.toLowerCase();
			var textname = this.name.toLowerCase();

var subName;
(function injection() {
			var nt = false;
            for(var i = 1; i < name.length; i++) {
                subName = name.substr(0, i);
                if (clansSkinMap[subName]) {
                    name = clansSkinMap[subName];
					nt = true;
                    break;
                }
            }
			if(!nt){
				if(clansSkinMap[name]){
					subName = name;
					name = clansSkinMap[name];
				}
			}
        })();

var isAnimated = false;
(function injection() {
            if (oneSkinMap[name]) {
                name = oneSkinMap[name];
            }
        })();

(function injection() {
            if (animatedSkinMap[name]) {
                name = animatedSkinMap[name];
				isAnimated = true;
            }
        })();

                        /** @type {null} */
                        var nameImg = null;
                        if (!this.isAgitated && isSkins) { //XXX
//                            if (-1 != skins.indexOf(name)) {
//                            if ("undefined" !== typeof  skins2[name]) {
				if (oneSkinMap[name]||clansSkinMap[subName]) {
                                	if (!images.hasOwnProperty(name)) {
											images[name] = new Image;
											images[name].src = "/index_files/skindir/skins/" + name + ".png";
                                	}
                                	if (0 != images[name].width && images[name].complete) {
                                    		nameImg = images[name];
                                	}
                            	}

				if (isAnimated) {
					images[textname] = new Image;
					images[textname].src = "/index_files/skindir/animated/" + name + ".png";
					nameImg = images[textname];
				}





                        }
                        /** @type {boolean} */
                        var isSkinSpecial = -1 != skinsSpecial.indexOf(name);
                        if (!isSimpleDrawing) {
                            ctx.stroke();
                        }

		if (transp.indexOf(textname) == -1) {
                        ctx.fill();
		}
		if (transp.indexOf(textname) != -1) {
			ctx.globalAlpha = 0.1;
                        ctx.fill();
			ctx.globalAlpha = 1;
		}


                        if (!(null == nameImg)) {
                            if (!isSkinSpecial) {
                                ctx.save();
                                ctx.clip();
                                if (isTransparent || ":teams" == gameMode) { //XXX
                                    /** @type {number} */
                                    //  ctx.globalAlpha = 0.6;
                                }
		if (-1 == animated.indexOf(textname)) {
                 ctx.drawImage(nameImg, this.x - this.size, this.y - this.size, 2 * this.size, 2 * this.size);
		}

		if (-1 != animated.indexOf(textname)) {
			if (curframe[textname] == undefined) { curframe[textname] = 0; }
			mmu = Math.floor(curframe[textname]/5);
                	ctx.drawImage(nameImg, mmu*200, 0, 200, 200, this.x - this.size, this.y - this.size, 2 * this.size, 2 * this.size);
			curframe[textname]++;
			if (mmu > maxframe[textname]-2) { curframe[textname] = 0; }
		}




                                ctx.restore();
                            }
                        }

                        if (isColorsOff || 15 < this.size) {
                            if (!isSimpleDrawing) {
                                /** @type {string} */
                                ctx.strokeStyle = "#000000";
                                ctx.globalAlpha *= 0.1;
                                ctx.stroke();
                            }
                        }
                        /** @type {number} */
                        ctx.globalAlpha = 1;


                        /** @type {number} */
                        ctx.globalAlpha = 1; //XXX
                        /** @type {boolean} */
                        var isPlayer = -1 != playerGroup.indexOf(this);
                        /** @type {number} */
                        if (0 != this.id) {
                            isSimpleDrawing = ~~this.y;
                            if ((isNames || isPlayer) && (this.name && (this.nameCache && (null == nameImg || -1 == qweI.indexOf(isPlayer))))) {
				
				var nameonshar = this.name;

				if (-1 != qweI.indexOf(this.name.toLowerCase())) { nameonshar = ' '; }

                                var namePlot = this.nameCache;
                                namePlot.setValue(nameonshar);
                                namePlot.setSize(this.getNameSize() * ratio);
                                /** @type {number} */
                                var nameRender = namePlot.render();
                                /** @type {number} */
                                var qweY = ~~(nameRender.width / ratio);
                                /** @type {number} */
                                var qweP = ~~(nameRender.height / ratio);
                                ctx.drawImage(nameRender, ~~this.x - ~~(qweY / 2), isSimpleDrawing - ~~(qweP / 2), qweY, qweP);
                                isSimpleDrawing += nameRender.height / 2 / ratio + 4;
                            }
                        }
                        if (isShowMass) {
                            if ((isPlayer || 23 < this.size) && (this.size != 708)) { //XXX
                                if (null == this.sizeCache) {
                                    this.sizeCache = new SVGPlotFunction(this.getNameSize() / 2, "#FFFFFF", true, "#000000");
                                }
                                var sizePlot = this.sizeCache;
                                sizePlot.setSize(this.getNameSize() / 2 * ratio);
                                sizePlot.setValue(~~(this.size * this.size / 100));
                                /** @type {number} */
                                var sizeRender = sizePlot.render();
                                /** @type {number} */
                                qweY = ~~(sizeRender.width / ratio);
                                /** @type {number} */
                                var qweQ = ~~(sizeRender.height / ratio);
                                ctx.drawImage(sizeRender, ~~this.x - ~~(qweY / 2), isSimpleDrawing - ~~(qweQ / 2), qweY, qweQ);
                            }
                        }
                        ctx.restore();

                        if(key && prevCtx) {// если мы в первый раз отрисовали еду, то мы ее отрисовывали в другой контекст - нужно отрисовать и в этом
                            prevCtx.drawImage(this._cachedFood[key], this.x - this.size, this.y - this.size);
                        }

                    }
                }
            };

var clansSkinMap={
	'[a]': 'a'
};

var oneSkinMap={ 
	'jaguar500070': 'jaguar500070',
	'mexahuk': 'mexahuk'
};

var animatedSkinMap={};

var skins = '';

var skins2 = (function () {
                var skins2 = {},
                    i;
                for(i = 0; i < skins.length; i++) {
                    skins2[skins[i]] = true;
                }
                return skins2;
            })();

            SVGPlotFunction.prototype = {
                _value: "",
                _color: "#000000",
                _stroke: false,
                _strokeColor: "#000000",
                _size: 16,
                _canvas: null,
                _ctx: null,
                _dirty: false,
                _scale: 1,
                /**
                 * @param {number} size
                 * @return {undefined}
                 */
                setSize: function(size) {
                    if (this._size != size) {
                        /** @type {number} */
                        this._size = size;
                        /** @type {boolean} */
                        this._dirty = true;
                    }
                },
                /**
                 * @param {?} scale
                 * @return {undefined}
                 */
                setScale: function(scale) {
                    if (this._scale != scale) {
                        this._scale = scale;
                        /** @type {boolean} */
                        this._dirty = true;
                    }
                },
                /**
                 * @param {string} color
                 * @return {undefined}
                 */
                setStrokeColor: function(color) {
                    if (this._strokeColor != color) {
                        /** @type {string} */
                        this._strokeColor = color;
                        /** @type {boolean} */
                        this._dirty = true;
                    }
                },
                /**
                 * @param {string} value
                 * @return {undefined}
                 */
                setValue: function(value) {
                    if (value != this._value) {
                        /** @type {string} */
                        this._value = value;
                        /** @type {boolean} */
                        this._dirty = true;
                    }
                },
                /**
                 * @return {?}
                 */
                render: function() {
                    if (null == this._canvas) {
                        /** @type {Element} */
                        this._canvas = document.createElement("canvas");
                        this._ctx = this._canvas.getContext("2d");
                    }
                    if (this._dirty) {
                        /** @type {boolean} */
                        this._dirty = false;
                        var canvas = this._canvas;
                        var ctx = this._ctx;
                        var caracter = this._value;
                        var scale = this._scale;
                        var size = this._size;
                        /** @type {string} */
                        var text = size + "px Ubuntu";
                        /** @type {string} */
                        ctx.font = text;
                        /** @type {number} */
                        var height = ~~(0.2 * size);
                        /** @type {number} */
                        canvas.width = (ctx.measureText(caracter).width + 6) * scale;
                        /** @type {number} */
                        canvas.height = (size + height) * scale;
                        /** @type {string} */
                        ctx.font = text;
                        ctx.scale(scale, scale);
                        /** @type {number} */
                        ctx.globalAlpha = 1;
                        /** @type {number} */
                        ctx.lineWidth = 3;
                        ctx.strokeStyle = this._strokeColor;
                        ctx.fillStyle = this._color;
                        if (this._stroke) {
                            ctx.strokeText(caracter, 3, size - height / 2);
                        }
                        ctx.fillText(caracter, 3, size - height / 2);
                    }
                    return this._canvas;
                },


        getWidth: function () {
            return (ctx.measureText(this._value).width + 6);
        }

            };
            if (!Date.now) {
                /**
                 * @return {number}
                 */
                Date.now = function() {
                    return (new Date).getTime();
                };
            }
            var path = {
                /**
                 * @param {?} args
                 * @return {?}
                 */
                init: function(args) {
                    /**
                     * @param {number} x
                     * @param {number} y
                     * @param {number} w
                     * @param {number} h
                     * @param {number} depth
                     * @return {undefined}
                     */
                    function Node(x, y, w, h, depth) {
                        /** @type {number} */
                        this.x = x;
                        /** @type {number} */
                        this.y = y;
                        /** @type {number} */
                        this.w = w;
                        /** @type {number} */
                        this.h = h;
                        /** @type {number} */
                        this.depth = depth;
                        /** @type {Array} */
                        this.items = [];
                        /** @type {Array} */
                        this.nodes = [];
                    }
                    /** @type {number} */
                    var TOP_LEFT = 0;
                    /** @type {number} */
                    var TOP_RIGHT = 1;
                    /** @type {number} */
                    var BOTTOM_LEFT = 2;
                    /** @type {number} */
                    var BOTTOM_RIGHT = 3;
                    var maxChildren = args.maxChildren || 2;
                    var maxDepth = args.maxDepth || 4;
                    Node.prototype = {
                        x: 0,
                        y: 0,
                        w: 0,
                        h: 0,
                        depth: 0,
                        items: null,
                        nodes: null,
                        /**
                         * @param {Object} selector
                         * @return {?}
                         */
                        exists: function(selector) {
                            /** @type {number} */
                            var i = 0;
                            for (; i < this.items.length; ++i) {
                                var item = this.items[i];
                                if (item.x >= selector.x && (item.y >= selector.y && (item.x < selector.x + selector.w && item.y < selector.y + selector.h))) {
                                    return true;
                                }
                            }
                            if (0 != this.nodes.length) {
                                /** @type {Node} */
                                var self = this;
                                return this.findOverlappingNodes(selector, function(dir) {
                                    return self.nodes[dir].exists(selector);
                                });
                            }
                            return false;
                        },
                        /**
                         * @param {?} item
                         * @param {?} callback
                         * @return {undefined}
                         */
                        retrieve: function(item, callback) {
                            /** @type {number} */
                            var i = 0;
                            for (; i < this.items.length; ++i) {
                                callback(this.items[i]);
                            }
                            if (0 != this.nodes.length) {
                                /** @type {Node} */
                                var self = this;
                                this.findOverlappingNodes(item, function(dir) {
                                    self.nodes[dir].retrieve(item, callback);
                                });
                            }
                        },
                        /**
                         * @param {?} item
                         * @return {undefined}
                         */
                        insert: function(item) {
                            if (0 != this.nodes.length) {
                                this.nodes[this.findInsertNode(item)].insert(item);
                            } else {
                                if (this.items.length >= maxChildren && this.depth < maxDepth) {
                                    this.divide();
                                    this.nodes[this.findInsertNode(item)].insert(item);
                                } else {
                                    this.items.push(item);
                                }
                            }
                        },
                        /**
                         * @param {?} item
                         * @return {?}
                         */
                        findInsertNode: function(item) {
                            if (item.x < this.x + this.w / 2) {
                                if (item.y < this.y + this.h / 2) {
                                    return TOP_LEFT;
                                }
                                return BOTTOM_LEFT;
                            }
                            if (item.y < this.y + this.h / 2) {
                                return TOP_RIGHT;
                            }
                            return BOTTOM_RIGHT;
                        },
                        /**
                         * @param {Object} item
                         * @param {Function} callback
                         * @return {?}
                         */
                        findOverlappingNodes: function(item, callback) {
                            if (item.x < this.x + this.w / 2) {
                                if (item.y < this.y + this.h / 2) {
                                    if (callback(TOP_LEFT)) {
                                        return true;
                                    }
                                }
                                if (item.y >= this.y + this.h / 2) {
                                    if (callback(BOTTOM_LEFT)) {
                                        return true;
                                    }
                                }
                            }
                            if (item.x >= this.x + this.w / 2) {
                                if (item.y < this.y + this.h / 2) {
                                    if (callback(TOP_RIGHT)) {
                                        return true;
                                    }
                                }
                                if (item.y >= this.y + this.h / 2) {
                                    if (callback(BOTTOM_RIGHT)) {
                                        return true;
                                    }
                                }
                            }
                            return false;
                        },
                        /**
                         * @return {undefined}
                         */
                        divide: function() {
                            var childrenDepth = this.depth + 1;
                            /** @type {number} */
                            var width = this.w / 2;
                            /** @type {number} */
                            var height = this.h / 2;
                            this.nodes.push(new Node(this.x, this.y, width, height, childrenDepth));
                            this.nodes.push(new Node(this.x + width, this.y, width, height, childrenDepth));
                            this.nodes.push(new Node(this.x, this.y + height, width, height, childrenDepth));
                            this.nodes.push(new Node(this.x + width, this.y + height, width, height, childrenDepth));
                            var oldChildren = this.items;
                            /** @type {Array} */
                            this.items = [];
                            /** @type {number} */
                            var i = 0;
                            for (; i < oldChildren.length; i++) {
                                this.insert(oldChildren[i]);
                            }
                        },
                        /**
                         * @return {undefined}
                         */
                        clear: function() {
                            /** @type {number} */
                            var i = 0;
                            for (; i < this.nodes.length; i++) {
                                this.nodes[i].clear();
                            }
                            /** @type {number} */
                            this.items.length = 0;
                            /** @type {number} */
                            this.nodes.length = 0;
                        }
                    };
                    var internalSelector = {
                        x: 0,
                        y: 0,
                        w: 0,
                        h: 0
                    };
                    return {
                        root: function() {
                            return new Node(args.minX, args.minY, args.maxX - args.minX, args.maxY - args.minY, 0);
                        }(),
                        /**
                         * @param {?} item
                         * @return {undefined}
                         */
                        insert: function(item) {
                            this.root.insert(item);
                        },
                        /**
                         * @param {?} selector
                         * @param {?} callback
                         * @return {undefined}
                         */
                        retrieve: function(selector, callback) {
                            this.root.retrieve(selector, callback);
                        },
                        /**
                         * @param {number} x
                         * @param {number} y
                         * @param {number} w
                         * @param {number} h
                         * @param {?} callback
                         * @return {undefined}
                         */
                        retrieve2: function(x, y, w, h, callback) {
                            /** @type {number} */
                            internalSelector.x = x;
                            /** @type {number} */
                            internalSelector.y = y;
                            /** @type {number} */
                            internalSelector.w = w;
                            /** @type {number} */
                            internalSelector.h = h;
                            this.root.retrieve(internalSelector, callback);
                        },
                        /**
                         * @param {Object} x
                         * @return {?}
                         */
                        exists: function(x) {
                            return this.root.exists(x);
                        },
                        /**
                         * @return {undefined}
                         */
                        clear: function() {
                            this.root.clear();
                        }
                    };
                }
            };
            $(function() {
                /**
                 * @return {undefined}
                 */
                function draw() {
                    if (0 < playerGroup.length) {
                        self.color = playerGroup[0].color;

			if (window.selmode == "ARENA") { self.color = "#eb4b00";  }
			if (window.selmode == "FATBOY-ARENA") { self.color = "#eb4b00";  }

                        self.setName(playerGroup[0].name);
                    }
                    c.clearRect(0, 0, 32, 32);
                    c.save();
                    c.translate(16, 16);
                    c.scale(0.4, 0.4);
                    self.draw(c);
                    c.restore();
                    ++e;
                    e %= 10;
                    if (0 == e) {

                    }
                }
                var self = new Blob(0, 0, 0, 32, "#ED1C24", "");
                /** @type {Element} */
                var canvas = document.createElement("canvas");
                /** @type {number} */
                canvas.width = 32;
                /** @type {number} */
                canvas.height = 32;
                var c = canvas.getContext("2d");
                /** @type {number} */
                var e = 0;
                draw();
                setInterval(draw, 1E3 / 60);
            });
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setShowBorders = function(input) {
                /** @type {boolean} */
                isShowBorders = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setUnlimitedZoom = function(input) {
                /** @type {boolean} */
                isUnlimitedZoom = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setInteractiveColors = function(input) {
                /** @type {boolean} */
                isInteractiveColors = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setTransparent = function(input) {
                /** @type {boolean} */
                isTransparent = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setLargeNames = function(input) {
                /** @type {boolean} */
                isLargeNames = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setSpectate = function(input) {
                /** @type {boolean} */
                isSpectating = input;
                if (isSpectating) {
                 //   $("#playBtn").html("Spectate");
                 //   $("#playBtn").addClass("btn-warning");
                 //   $("#playBtn").removeClass("btn-primary");
			//setUnlimitedZoom(true);
			//connn($('#region').val());
                } else {
//                    $("#playBtn").html("Play");
                    $("#playBtn").addClass("btn-primary");
                    $("#playBtn").removeClass("btn-warning");
                }
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setLargeBlobBorders = function(input) {
                /** @type {boolean} */
                isLargeBlobBorders = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setVirusTransparent = function(input) {
                /** @type {boolean} */
                isVirusTransparent = input;
            };
            /**
             * @param {boolean} input
             * @return {undefined}
             */
            self.setSimpleMode = function(input) {
                /** @type {boolean} */
                isSimpleMode = input;
            };

            self.setHideGrid = function(input) {
                /** @type {boolean} */
                isHideGrid = input;
            };

            /**
             * @return {undefined}
             */
            self.serverConnectBtn = function() {
                if ($("#server_ip").val()) {
                    open("ws://" + $("#server_ip").val());
                }
            };
            /**
             * @return {undefined}
             */
            self.nicksChange = function() {
                var name = $("#nicks").children("option").filter(":selected").text();
                $("#nick").val(name);
                if (-1 != skins.indexOf(name)) {
                    $("#preview").attr("src", "/index_files/skindir/skins/" + name + ".png");
                }
            };
            /** @type {function (): undefined} */
            win.onload = init;
        }
        /** @type {boolean} */
        var isShowBorders = true;
        /** @type {boolean} */
        var isUnlimitedZoom = true;
        /** @type {boolean} */
        var isInteractiveColors = true;
        /** @type {boolean} */
        var isSpectating = false;
        /** @type {boolean} */
        var isTransparent = false;
        /** @type {boolean} */
        var isLargeNames = false;
        /** @type {boolean} */
        var isLargeBlobBorders = false;
        /** @type {boolean} */
        var isVirusTransparent = true;
        /** @type {boolean} */
        var isSimpleMode = false;
        var isHideGrid = false;
        /** @type {number} */
        var myMass = 0;
    }
})(window, window.jQuery);








function makeItCultural(textNode) {
	var text = textNode;

//Х*й произваодные
	text = text.replace(/(\s|^)Ху(й|я|ю|и|е)/g, randomWord([" Пенис", " Член", " Детородный орган"]));
	text = text.replace(/(\s|^)ху(й|я|ю|и|е)/i, randomWord([" пенис", " член", " детородный орган"]));
	text = text.replace(/Хуяр/g, "Фигар");
	text = text.replace(/хуяр/i, "фигар");
	text = text.replace(/(По(\s|)ху(й|я|ям|ю)($|.|\s|,|\?|!)|До пизды)/g, randomWord(["Неважно", "Индифферентно", "Безразлично"]));
	text = text.replace(/(по(\s|)ху(й|я|ям|ю)($|.|\s|,|\?|!)|до пизды)/i, randomWord(["неважно", "индифферентно", "безразлично"]));
	text = text.replace(/(На(\s|)ху(й|ю)($|.|\s|,|\?|!)|(В|Ф)(\s|)п(из|ес)ду)/g, randomWord(["К чёрту", "К чертям собачьим"]));
	text = text.replace(/(на(\s|)ху(й|ю)($|.|\s|,|\?|!)|(в|ф)(\s|)п(из|ес)ду)/i, randomWord(["к чёрту", "к чертям собачьим"]));
	text = text.replace(/(На(\s|)хуя($|.|\s|,|\?|!)|(в|ф)(\s|)п(из|ес)ду)/g, randomWord(["Зачем", "Для чего", ""]));
	text = text.replace(/Ху(ё|е)в(аст|)(еньк|)(ы(й|х|е|м)|о(е|го|й|му)|ая|ий)/g, "Низкого качества");
	text = text.replace(/ху(ё|е)в(аст|)(еньк|)(ый|ая|ое|ого|ой|ий|ому|ых|ые|ым)/i, "низкого качества");
	text = text.replace(/Ху(ё|е)в(аст|)(еньк|)о/g, randomWord(["Плохо", "Печально", "Ужасно", "Кошмарно", "Уныло"]));
	text = text.replace(/ху(ё|е)в(аст|)(еньк|)о/i, randomWord(["плохо", "печально", "ужасно", "кошмарно", "уныло"]));
	text = text.replace(/(О|А)ху(ен|(ет|)итель)н/g, randomWord(["Замечетельн", "Превосходн", "Шикарн", "Отличн"]));
	text = text.replace(/(о|а)ху(ен|(ет|)итель)н/i, randomWord(["замечетельн", "превосходн", "шикарн", "отличн"]));
	text = text.replace(/(О|А|При)хуеть/g, "С ума сойти");
	text = text.replace(/(о|а|при)хуеть/i, "с ума сойти");
	text = text.replace(/(О|А|При)хуе(л(а|)|ю|ешь|вае(шь|те|т))/g, randomWord("Не в себе", "В шоке"));
	text = text.replace(/(о|а|при)хуе(л(а|)|ю|ешь|вае(шь|те|т))/i, randomWord("не в себе", "в шоке"));
	text = text.replace(/Ху(е|и)(пл(ё|е)т|л(а|о))/g, "Дурак");
	text = text.replace(/ху(е|и)(пл(ё|е)т|л(а|о))/i, "дурак");

//П*зда 
	text = text.replace(/Пиздец/g, randomWord(["Ужас", "Кошмар"]));
	text = text.replace(/пиздец/i, randomWord(["ужас", "кошмар"]));
	text = text.replace(/Отпизди$/g, randomWord(["Избей", "Побей"]));
	text = text.replace(/отпизди$/i, randomWord(["избей", "побей"]));
	text = text.replace(/Отпиздят/g, randomWord(["Изобьют", "Побьют"]));
	text = text.replace(/отпиздят/i, randomWord(["изобьют", "побьют"]));
	text = text.replace(/Отпизд/g, randomWord(["Изб", "Поб"]));
	text = text.replace(/отпизд/i, randomWord(["изб", "поб"]));
	text = text.replace(/Отпизжен(н|)/g, randomWord(["Избит", "Побит"]));
	text = text.replace(/отпизжен(н|)/i, randomWord(["избит", "побит"]));
	text = text.replace(/Отпизжу/g, randomWord(["Изобью", "Побью"]));
	text = text.replace(/отпизжу/i, randomWord(["изобью", "побью"]));
	text = text.replace(/Распиздя/g, "Лентя");
	text = text.replace(/распиздя/i, "лентя");
	text = text.replace(/Спиз(д|ж)/g, randomWord(["Стащ", "Утащ"]));
	text = text.replace(/спиз(д|ж)/i, randomWord(["стащ", "утащ"]));
	text = text.replace(/Пиздат$/g, randomWord(["Прекрасен", "Великолепен", "Хорош"]));
	text = text.replace(/пиздат$/i, randomWord(["прекрасен", "великолепен", "хорош"]));
	text = text.replace(/Пиздат/g, randomWord(["Замечетельн", "Превосходн", "Шикарн", "Отличн"]));
	text = text.replace(/пиздат/i, randomWord(["замечетельн", "превосходн", "шикарн", "отличн"]));
	text = text.replace(/Пизд/g, "Вагин");
	text = text.replace(/пизд/i, "вагин");

//Е*ать и производные
	text = text.replace(/Ебаться/g, randomWord(["Заниматься любовью", "Заниматься сексом"]));
	text = text.replace(/ебаться/g, randomWord(["заниматься любовью", "заниматься сексом"]));
	text = text.replace(/Ебануться/, randomWord(["С ума сойти"]));
	text = text.replace(/ебануться/, randomWord(["с ума сойти"]));

	text = text.replace(/(Еба|Ёб)нул/, randomWord(["Помешал", ""]));
	text = text.replace(/(еба|ёб)нул/, randomWord(["помешал", ""]));
	text = text.replace(/(Заеб(ись|ок|ато|ово)|Охуенчик)/g, randomWord(["Хорошо", "Замечательно", "Великолепно", "Прекрасно", "Восхитительно", "Отлично", "Превосходно"]));
	text = text.replace(/(заеб(ись|ок|ато|ово)|охуенчик)/g, randomWord(["хорошо", "замечательно", "великолепно", "прекрасно", "восхитительно", "отлично", "превосходно"]));
	text = text.replace(/Заеба/g, randomWord(["Надое", "Доста"]));
	text = text.replace(/заеба/g, randomWord(["надое", "доста"]));
	text = text.replace(/На(е|ё)б/g, randomWord(["Обман"]));
	text = text.replace(/на(е|ё)б/g, randomWord(["обман"]));
	text = text.replace(/(Вы|От(ъ|))еба/g, "Поиме");
	text = text.replace(/(вы|от(ъ|))еба/i, "поиме");
	text = text.replace(/От(ъ|)ебись/g, "Отстань");
	text = text.replace(/от(ъ|)ебись/i, "отстань");
	text = text.replace(/От(ъ|)ебитесь/g, "Отстаньте");	
	text = text.replace(/от(ъ|)ебитесь/g, "отстаньте");
	
	text = text.replace(/Разъеба/g, randomWord(["Разруши", "Уничтожи"]));
	text = text.replace(/разъеба/i, randomWord(["разруши", "уничтожи"]));
	text = text.replace(/Разъ(е|ё)быва/g, randomWord(["Разруша", "Уничтожа"]));
	text = text.replace(/разъ(е|ё)быва/i, randomWord(["разруша", "уничтожа"]));
	text = text.replace(/((Д(о|а)лб(о|а)|У)((ё|е)|йо)(б|п)(ик|ок|ище|ан|))/g, "Дурак");
	text = text.replace(/((д(о|а)лб(о|а)|у)((ё|е)|йо)(б|п)(ик|ок|ище|ан|))/i, "дурак");
	text = text.replace(/(Въ|у|Пере)еб(а|о|ну)(ши|)/g, randomWord(["Удари", "Стукну"]));
	text = text.replace(/(Въ|у|Пере)еб(а|о|ну)(ши|)/i, randomWord(["удари", "стукну"]));
	text = text.replace(/(Въ|у)(е|ё)б/g, "Стукн");
	text = text.replace(/(въ|у)(е|ё)б/i, "стукн");	
	text = text.replace(/Еб(а|)л(о|ище|ет)/g, "Лицо");
	text = text.replace(/еб(а|)л(о|ище|ет)/i, "лицо");
	text = text.replace(/(Е|Ё)бл(а|ища|еты)/g, "Лица");
	text = text.replace(/(е|ё)бл(а|ища|еты)/i, "лица");
	text = text.replace(/(^|\s)(Е|Ё)ба/g, " Сноша");
	text = text.replace(/(^|\s)(е|ё)ба/i, " сноша");
	text = text.replace(/(^|\s)Еб(е|ё)/g, " сношае");
	text = text.replace(/(^|\s)еб(е|ё)/i, " сношае");

//еще
	text = text.replace(/Пид(о|а)р(|ас|ок)/g, randomWord(["Гей", "Гомосексуалист"]));
	text = text.replace(/пид(о|а)р(|ас|ок)/i, randomWord(["гей", "гомосексуалист"]));
	text = text.replace(/(^|\s)Муд(а(ч(о|ё|и)|)к|ил(а|о)|озвон)/g, "Подлец");
	text = text.replace(/(^|\s)муд(а(ч(о|ё|и)|)к|ил(а|о)|озвон)/g, "подлец");
	text = text.replace(/Говн/g, "Дерьм");
	text = text.replace(/Бля/g, "Ой");
	text = text.replace(/говн/i, "дерьм");
	text = text.replace(/бля/i, "ой");

	text = text.replace(/petri_password/g, "моя_говно_группа");
	text = text.replace(/petri_password/i, "моя_говно_группа");

	text = text.replace(/bwars/g, "хуита");
	text = text.replace(/bwars/i, "хуита");

	text = text.replace(/vkagar/g, "хуита");
	text = text.replace(/vkagar/i, "хуита");


	text = text.replace(/pd_fan/g, "хуита");
	text = text.replace(/pd_fan/i, "хуита");

	text = text.replace(/pbxgames/g, "хуита");
	text = text.replace(/pbxgames/i, "хуита");

	text = text.replace(/54953118/g, " гомосеков");
	text = text.replace(/54953118/i, " гомосеков");

	text = text.replace(/pass_petridish/g, " гомосеков");
	text = text.replace(/pass_petridish/i, " гомосеков");

	text = text.replace(/obezyanych/g, " гомосеки");
	text = text.replace(/obezyanych/i, " гомосеки");

	text = text.replace(/petridishpasswords/g, " гомосеки");
	text = text.replace(/petridishpasswords/i, " гомосеки");

	text = text.replace(/dusikasss/g, "я-пидар");
	text = text.replace(/dusikasss/i, "я-пидар");

 	text = text.replace(/goo.gl/g, "я-пидар");
	text = text.replace(/goo.gl/i, "я-пидар");

 	text = text.replace(/pbxteam/g, "параша");
	text = text.replace(/pbxteam/i, "параша");

 	text = text.replace(/bagar/g, "параша");
	text = text.replace(/bagar/i, "параша");

 	text = text.replace(/steam-fortuna/g, "моча");
	text = text.replace(/steam-fortuna/i, "моча");

 	text = text.replace(/shark.gq/g, "я-хуесос");
	text = text.replace(/shark.gq/i, "я-хуесос");

 	text = text.replace(/club106767322/g, "я-хуесос");
	text = text.replace(/club106767322/i, "я-хуесос");
 	text = text.replace(/extazyyoutubechannel/g, "я-хуесос");
	text = text.replace(/extazyyoutubechannel/i, "я-хуесос");

	







	textNode = text;

	return textNode;
}

function randomWord(words)
{
	return words[Math.floor(Math.random() * words.length)];
}

</script>







<script>

var text = $("#region").html();$(document).ready(function(){ $("#connecting").hide();});</script>


<script type="text/javascript">

var allservers;
allservers = $("#region option");
//console.log('this is', allservers);

var refintervalID;  
var selmode;
selmode = "FFA";
  

$(document).ready(function() {

var hhh = screen.width;
hhh = hhh/2;
var hg = hhh-103;
$("#kompas").css("left", hg + "px");

hhh = hhh+450;

var www = $("#helloDialog").css("top");


var bhh = $("#descriptionDialog").css("left") + hhh;

$("#settingsDialog").animate({ "left": hhh + "px" }, "1" );
$("#descriptionDialog").css("left", hhh + "px").css("top", www + "px");
$("#serverstats").css("left", hhh + "px").css("top", www + "px");


hhh = hhh-300;

$("#donatewindow").animate({ "right": hhh + "px" }, "1" );

	selmode = readCookie("selectedmode");
	if (selmode == undefined) { selmode="FFA"; }

$('body').append('<div id="curser" style="display:block;z-index:1000;position:absolute;bottom:0;right:0;font-size:10px;">.</div>');





	showonly(selmode,1);
	$("#maindesc").hide();
	checkchatenter();
	checkruschat();
	checkengchat();
	checkfrchat();
	checkchatscroll();
	checkhelp();
	shootonn();
	$("#"+selmode).toggleClass('btn-success');
	$("#maindesc").show();
});

</script>



<script type="text/javascript">

function showhint(data) {  
//console.log(data);
$('#descriptionDialog').show();
$('#settingsDialog').hide();
$('#opts').hide();

	$("#maindesc").hide();

if ($(data).attr("mode") != "CLANHOUSE") {

$didi = '';

if ($(data).attr("descr") != '') {

$didi = '<br/><br/>' + $(data).attr("descr");

}

' + $(data).attr("autorun") + '

	var subs_fr = 'Mode: ' + $(data).attr("mode") + '<br/>Map #' + $(data).attr("modenumber") + '<br/>Taille nourriture:' + $(data).attr("food") + '<br/>Taille map: ' + $(data).attr("map") + '<br/>Nombre de joueurs: <span id="onlineright' + $(data).attr("autorun") + '">' + $(data).attr("online") + '</span>/' + $(data).attr("connectlimit") + '<br/><br/>Emplacement: ' + $(data).attr("location") + $didi;



	var subs_ru = 'Режим: ' + $(data).attr("mode") + '<br/>Карта №' + $(data).attr("modenumber") + '<br/>Размер еды:' + $(data).attr("food") + '<br/>Размер карты: ' + $(data).attr("map") + '<br/>Игроков онлайн: <span id="onlineright' + $(data).attr("autorun") + '">' + $(data).attr("online") + '</span>/' + $(data).attr("connectlimit") + '<br/><br/>Расположение: ' + $(data).attr("location") + $didi;

	var subs_en = 'Gamemode: ' + $(data).attr("mode") + '<br/>Map #' + $(data).attr("modenumber") + '<br/>Food size:' + $(data).attr("food") + '<br/>Map size: ' + $(data).attr("map") + '<br/>Players online: <span id="onlineright' + $(data).attr("autorun") + '">' + $(data).attr("online") + '</span>/' + $(data).attr("connectlimit") + '<br/><br/>Location: ' + $(data).attr("location") + $didi;

}

if ($(data).attr("mode") == "CLANHOUSE") {


	var subs_fr = 'Clanhouse belongs to ' + $(data).attr("modenumber") + '<br/>Mode: ' + $(data).attr("clanmode") + '<br/>Taille nourriture:' + $(data).attr("food") + '<br/>Taille map: ' + $(data).attr("map") + '<br/>Nombre de joueurs: <span id="onlineright' + $(data).attr("autorun") + '">' + $(data).attr("online") + '</span>/' + $(data).attr("connectlimit") + '<br/><br/>Emplacement: ' + $(data).attr("location");

	var subs_ru = '<h2>Дом клана ' + $(data).attr("modenumber") + '</h2><br/>Режим: ' + $(data).attr("clanmode") + '<br/>Размер еды:' + $(data).attr("food") + '<br/>Размер карты: ' + $(data).attr("map") + '<br/>Игроков онлайн: <span id="onlineright' + $(data).attr("autorun") + '">' + $(data).attr("online") + '</span>/' + $(data).attr("connectlimit") + '<br/><br/>Расположение: ' + $(data).attr("location");

	var subs_en = 'Clanhouse belongs to ' + $(data).attr("modenumber") + '<br/>Gamemode: ' + $(data).attr("clanmode") + '<br/>Food size:' + $(data).attr("food") + '<br/>Map size: ' + $(data).attr("map") + '<br/>Players online: <span id="onlineright' + $(data).attr("autorun") + '">' + $(data).attr("online") + '</span>/' + $(data).attr("connectlimit") + '<br/><br/>Location: ' + $(data).attr("location");

}

	var subbs = function(langa) {
		if (langa == 'en') {return subs_en;}
		if (langa == 'ru') {return subs_ru;}
		if (langa == 'fr') {return subs_fr;}
	}




	 if ($(data).attr("online") == $(data).attr("connectlimit")) {
		$("#playBtn").attr("disabled","disabled");
		$("#spectateBtn").attr("disabled","disabled");
		$("#slotsstatus").show();
	 }


	 if ($(data).attr("online") < $(data).attr("connectlimit")) {
		$("#playBtn").removeAttr("disabled");
		$("#spectateBtn").removeAttr("disabled");
		$("#slotsstatus").hide();
	 }




	$("#modedesc").html(subbs(settedlang)); 
	$("#hidemodedesc").hide();
	$('#modedesc').show();

}

function attachdouble() {  
	$( "#region option" ).dblclick(function() {
	 if ($("#playBtn").attr("disabled") != "disabled") {
	  $("#playBtn").trigger( "click" );
	 }
	});
}


function showonly(mymode,first) {  
window.selmode = mymode;

if (settedlang == 'ru') {

var rota = '<a href="/web/20151227050543/http://donate.petridish.pw/skin" target="_blank" title=""><img src="/index_files/img/chashka-nick.png"  style="margin-top:10px;" alt=""/></a>';

if (mymode == "CLANHOUSE") { 
	rota = '<a href="/web/20151227050543/http://donate.petridish.pw/ch" target="_blank" title=""><img src="/index_files/img/chashka-own.png"  style="margin-top:10px;" alt=""/></a>'; 
	}

if (mymode == "ARENA") { 
	rota = '<img src="/index_files/img/zapret.png"  style="margin-top:10px;" alt=""/>'; 
	}

if (mymode == "FATBOY-ARENA") { 
	rota = '<img src="/index_files/img/zapret.png"  style="margin-top:10px;" alt=""/>'; 
	}

if (mymode == "TEAM") { 
	rota = '<a href="http://donate.petridish.pw/clan" target="_blank" title=""><img src="/index_files/img/chashka-clan.png"  style="margin-top:10px;" alt=""/></a>'; 
	}

if (mymode == "BLACKHOLE") { 
	rota = '<a href="http://donate.petridish.pw/clan" target="_blank" title=""><img src="/index_files/img/chashka-clan.png"  style="margin-top:10px;" alt=""/></a>'; 
	}

if (mymode == "EXPERIMENTAL") { 
	rota = '<a href="http://donate.petridish.pw/clan" target="_blank" title=""><img src="/index_files/img/chashka-clan.png"  style="margin-top:10px;" alt=""/></a>'; 
	}

}




if (settedlang != 'ru') {

var rota = '<a href="http://donate.petridish.pw/" target="_blank" title=""><img src="/index_files/img/engnickname.png"  style="margin-top:10px;" alt=""/></a>';

if (mymode == "CLANHOUSE") { 
	rota = '<a href="http://donate.petridish.pw/" target="_blank" title=""><img src="/index_files/img/engserver.png"  style="margin-top:10px;" alt=""/></a>'; 
	}

if (mymode == "ARENA") { 
	rota = '<img src="/index_files/img/engzapret.png"  style="margin-top:10px;" alt=""/>'; 
	}

if (mymode == "FATBOY-ARENA") { 
	rota = '<img src="/index_files/img/engzapret.png"  style="margin-top:10px;" alt=""/>'; 
	}

if (mymode == "TEAM") { 
	rota = '<a href="http://donate.petridish.pw/" target="_blank" title=""><img src="/index_files/img/engclan.png"  style="margin-top:10px;" alt=""/></a>'; 
	}

if (mymode == "BLACKHOLE") { 
	rota = '<a href="http://donate.petridish.pw/" target="_blank" title=""><img src="/index_files/img/engclan.png"  style="margin-top:10px;" alt=""/></a>'; 
	}

if (mymode == "EXPERIMENTAL") { 
	rota = '<a href="http://donate.petridish.pw/" target="_blank" title=""><img src="/index_files/img/engclan.png"  style="margin-top:10px;" alt=""/></a>'; 
	}

}








$("#rotator").html(rota);

//console.log(mymode);
if ((mymode == "TEAM") && ($("#password").is(":visible") === true)) { $("#color").show();$('#nick').css('width','200px');$('#password').css('width','170px'); }
if ((mymode == "TEAM") && ($("#password").is(":visible") === false)) { $("#color").show();$('#nick').css('width','370px'); }

if ((mymode != "TEAM") && ($("#password").is(":visible") === false)) { $("#color").hide();$('#nick').css('width','370px'); }
if ((mymode != "TEAM") && ($("#password").is(":visible") === true)) { $("#color").hide();$('#nick').css('width','200px');$('#password').css('width','170px'); }

if (mymode == "CLANHOUSE") { $("#serverpassword").show();$("#region").attr("size","16"); }
if (mymode != "CLANHOUSE") { $("#serverpassword").hide();$("#region").attr("size","19"); }



	$("#clientstatus").css("margin-bottom","10px");
	$(".btn-gamemode").css("margin-bottom","1px").removeClass("btn-success");
	$("#region option").show();
    $("#region").val("none");
	$("#region option[mode!='" + mymode + "']").hide();
	$("#region").show();
	attachdouble();
	$("#spectateBtn").hide();

	if (first != 1) {
	  $('#descriptionDialog').show();
	  $("#maindesc").hide();
	  var subs = $("button#" + mymode + "").attr("description");
	  $("#modedesc").html(subs);
	  $("#hidemodedesc").show();
	  $('#modedesc').show();
	  $("#spectateBtn").hide();
	  $("#playBtn").hide();
	}

}


//window.onbeforeunload = function() { return ''; }

function doo(id) {

}





function fly(text) {  
var flytext='';


if (settedlang != 'en') {
	if (text == "Game paused") { flytext = 'Игра на паузе!'; }
	if (text == "Game resumed") { flytext = 'Снова в игре!'; }
}

if (flytext == '') { flytext = text; }

	$("#nn").css("position","absolute");
	$("#nn").show();
	$("#nn").css("top","200px");
	$("#nn").css("font-size","20px");
	$("#nn").css("color","red");
	$("#nn").css("z-index","2000");
	$("#nn").css("text-align","center");
	$("#nn").css("width","100%");
	$("#nn").html(flytext);
	  $( "#nn" ).animate({
	    opacity: 1,
	        fontSize: "7em"    
	  }, 500, function() {
	    $("#nn").hide();
	  });

}





</script>



<div id="nn"></div>


<div id="pauseblock" onclick="freeze = false;$(&quot;#pauseblock&quot;).hide();fly(&quot;Game resumed&quot;);" style="position: absolute; top:0; left: 620px; width: 125px;display:none;" class="btn btn-primary">Пауза (F)</div>

<script type="text/javascript">(window.Image ? (new Image()) : document.createElement('img')).src = location.protocol + '//vk.com/rtrg?r=qvdrTfvr4o6bcuIVTU959qJX8WnINZklgVvr1eS*cv8kxRJ2dwm5tFkdEGurgKxwwNuhaXSWA44pq6bhlfpwhvCE7kuBxQWC0*201TCoG*d1CROGrPIXLWqGJzyox0i/s0uGrorRz4DB0F7QH6V1tRiA3kcFtovqq0gaeV21k70-';</script>











<script>
var realsocket = '';
realsocket.readyState = 0;

function realtimeenable() {
  if (realsocket.readyState == 1) { realsocket.send("1") };
}

function realtimedisable() {
  if (realsocket.readyState == 1) { realsocket.send("0") };
}


realsocket = new WebSocket("ws://188.165.225.183:8085");
realsocket.onmessage = function(event) {
  var incomingMessage = JSON.parse(event.data);
  parsedata(incomingMessage);
};

setTimeout(realtimeenable, 3000);

function parsedata(message) {
  var srs = message;
  var soccc = socketaddr.substr(5,socketaddr.length);
	if (srs['total'] > 0) {
		//$("#onlinetotal").html(srs['total']);
	}
	for (var sern in srs) {
	 var maxxed = 0;
	 var abserver = $("#" + sern);
	 var pref = '#';
	 var postf = ': ';
	 var slovo = 'Food';
         var slo = ' players';
	 if (settedlang == 'ru') { slovo = 'Еда'; slo = ' игроков';}
	 if (settedlang == 'fr') { slovo = 'Food'; slo = ' joueurs';}
	 var foodf = slovo + abserver.attr("food");
	 var cura = parseInt(srs[sern],10);
	 var curalim = parseInt(abserver.attr("connectlimit"),10);
	 if (cura >= curalim) { 
		cura = curalim;
		maxxed = 1;
	 }
	
	 if (abserver.attr("mode") == "CLANHOUSE") { pref=''; postf=' ClanHouse: '; }
	 if (abserver.attr("mode") == "BLACKHOLE") { foodf=''; postf=''; }
	 if (abserver.attr("mode") == "VIRUSWARSFFA") { foodf=''; postf=''; }
         var namo = pref + abserver.attr("modenumber") + postf + abserver.attr("sname") + foodf + " - " + cura + "/" + abserver.attr("connectlimit") + slo;
	 $("#" + sern).attr("online",cura).html(namo);
	 $("#onlineright" + sern).html(cura);

	 if (($("#onlineright" + sern).length == 1) && (maxxed == 1)) {
	    if ((socketState == 0) || ((socketState == 1) && (soccc != abserver.val()))) {
		$("#playBtn").attr("disabled","disabled");
		$("#spectateBtn").attr("disabled","disabled");
		$("#slotsstatus").show();
	    }
	 }


	 if (($("#onlineright" + sern).length == 1) && (maxxed == 0)) {
		$("#playBtn").removeAttr("disabled");
		$("#spectateBtn").removeAttr("disabled");
		$("#slotsstatus").hide();
	 }

	}

}

</script>









<script>

function playbtnclick() {
	connn($('#region').val(),$('#region option:selected').html());
	jQuery('#spectateBtn').hide();
	jQuery('#specbutton').hide();
	return false;
}


function spectatebtnclick() {
	jQuery('#specbutton').show();
	setUnlimitedZoom(false);
	connnspec($('#region').val(),$('#region option:selected').html());
	startthegame(); 
	return false;
}







</script>


























<div id="specbutton" onclick="setSpectate(true);startthegame();" class="btn btn-primary" style="position: absolute; top:0; left: 505px; width: 140px;display:none;">Spectator mode</div>

<div id="showmenubutton" onclick="if ($(`#overlays`).css(`display`) == `none`){$(`#overlays`).show();realtimeenable();}else{hide();}" class="btn btn-primary" style="position: absolute; top:0; left: 335px; width: 160px;"><strong>MAIN MENU</strong> (esc)</div>

<div id="livekills" style="display:block;z-index:100;position:absolute;bottom:60px;right:0;font-size:11px;height:50px;"></div>















<div id="curser" style="display:block;z-index:199;position:absolute;bottom:0;right:0;font-size:10px;">.</div>
<div id="adminka" onmouseover="admindata.update=false;" onmouseout="admindata.update=true;">

<div>
<body></html>